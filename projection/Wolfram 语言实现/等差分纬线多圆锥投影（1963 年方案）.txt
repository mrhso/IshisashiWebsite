(*
data for interpolation
{{-Pi/2,-4Pi/9,-5Pi/12,-7Pi/18,-133Pi/360,-Pi/3,-5Pi/18,-Pi/4,-2Pi/9,-Pi/6,-47Pi/360,-Pi/9,-Pi/12,-Pi/18,0,Pi/18,Pi/12,Pi/9,47Pi/360,Pi/6,2Pi/9,Pi/4,5Pi/18,Pi/3,133Pi/360,7Pi/18,5Pi/12,4Pi/9,Pi/2},{-2750000/1592779,-2586250/1592779,-2496525/1592779,-2394300/1592779,-2311750/1592779,-2138775/1592779,-1854975/1592779,-1701800/1592779,-1540825/1592779,-1194900/1592779,-953125/1592779,-817925/1592779,-614075/1592779,-415975/1592779,0,415975/1592779,614075/1592779,817925/1592779,953125/1592779,1194900/1592779,1540825/1592779,1701800/1592779,1854975/1592779,2138775/1592779,2311750/1592779,2394300/1592779,2496525/1592779,2586250/1592779,2750000/1592779},{2062500/1592779,2429125/1592779,2592250/1592779,2758700/1592779,2874475/1592779,3085800/1592779,3370575/1592779,3491950/1592779,3603325/1592779,3803200/1592779,3916075/1592779,3969550/1592779,4034725/1592779,4083875/1592779,4125000/1592779,4083875/1592779,4034725/1592779,3969550/1592779,3916075/1592779,3803200/1592779,3603325/1592779,3491950/1592779,3370575/1592779,3085800/1592779,2874475/1592779,2758700/1592779,2592250/1592779,2429125/1592779,2062500/1592779}}
*)

b=11/10
lambdaN=Pi
c=(1-1/b)/lambdaN
y0[phi_]:=9953537phi/10000000+738069phi^3/50000000
yn[phi_]:=Piecewise[{{181392248840417625/190904706973308328+864053901581896775phi/(69419893444839392Pi)+16249844450320570575phi^2/(763618827893233312Pi^2)+5416614816773523525phi^3/(381809413946616656Pi^3),phi<-4Pi/9},{1406131892034634475/572714120919924984+17262189227021298925phi/(763618827893233312Pi)+33704436146966547975phi^2/(763618827893233312Pi^2)+854434764501126075phi^3/(27272100996186904Pi^3),-4Pi/9<=phi<-5Pi/12},{3965149273308313175/1309060847816971392+5104237502845930825phi/(190904706973308328Pi)+288642391814240325phi^2/(5339991803449184Pi^2)+7495328528001846225phi^3/(190904706973308328Pi^3),-5Pi/12<=phi<-7Pi/18},{4362460412944175/68897939358787968+2946768646803040975phi/(763618827893233312Pi)-27424522402145775phi^2/(5741494946565664Pi^2)-7458842783684854125phi^3/(668166474406579148Pi^3),-7Pi/18<=phi<-133Pi/360},{-294721233464308675/111959151458030448-178995374369007398075phi/(9927044762612033056Pi)-33452977023312675525phi^2/(522476040137475424Pi^2)-80189305494094893375phi^3/(1240880595326504132Pi^3),-133Pi/360<=phi<-Pi/3},{40369493560345825/81816302988560712+7713512069492966575phi/(763618827893233312Pi)+15554348490331311975phi^2/(763618827893233312Pi^2)+7549948071711105525phi^3/(381809413946616656Pi^3),-Pi/3<=phi<-5Pi/18},{-497266159632717325/3054475311572933248+4603296975203541275phi/(1527237655786466624Pi)-491045050559624175phi^2/(95452353486654164Pi^2)-11372739739488675phi^3/(1048926961391804Pi^3),-5Pi/18<=phi<-Pi/4},{35492663408633225/763618827893233312+8438717854807042625phi/(1527237655786466624Pi)+935620338682502325phi^2/(190904706973308328Pi^2)+243554310241031025phi^3/(95452353486654164Pi^3),-Pi/4<=phi<-2Pi/9},{93237589241568875/2290856483679699936+8319554245948065425phi/(1527237655786466624Pi)+434295404349663825phi^2/(95452353486654164Pi^2)+59471434693430775phi^3/(29369954918970512Pi^3),-2Pi/9<=phi<-Pi/6},{-6323095123645755775/119124537151344396672+18659963976175709675phi/(4963522381306016528Pi)-55376325825500997675phi^2/(9927044762612033056Pi^2)-22623093853669058625phi^3/(1240880595326504132Pi^3),-Pi/6<=phi<-47Pi/360},{4641884243479439875/16035995385757899552+7771240688155528175phi/(668166474406579148Pi)+292455354710356088175phi^2/(5345331795252633184Pi^2)+90671539283698726125phi^3/(668166474406579148Pi^3),-47Pi/360<=phi<-Pi/9},{-20611630606291925/120571393877878944-13893358837020025phi/(17354973361209848Pi)-1408232099230697925phi^2/(24632865415910752Pi^2)-38169744516452243025phi^3/(190904706973308328Pi^3),-Pi/9<=phi<-Pi/12},{283071694725846025/9163425934718799744+4937359073583215875phi/(763618827893233312Pi)+22928807272793528025phi^2/(763618827893233312Pi^2)+4059179690356131525phi^3/(27272100996186904Pi^3),-Pi/12<=phi<-Pi/18},{7327072894633817525phi/(1527237655786466624Pi)-11957906153394742725phi^3/(381809413946616656Pi^3),-Pi/18<=phi<Pi/18},{-283071694725846025/9163425934718799744+4937359073583215875phi/(763618827893233312Pi)-22928807272793528025phi^2/(763618827893233312Pi^2)+4059179690356131525phi^3/(27272100996186904Pi^3),Pi/18<=phi<Pi/12},{20611630606291925/120571393877878944-13893358837020025phi/(17354973361209848Pi)+1408232099230697925phi^2/(24632865415910752Pi^2)-38169744516452243025phi^3/(190904706973308328Pi^3),Pi/12<=phi<Pi/9},{-4641884243479439875/16035995385757899552+7771240688155528175phi/(668166474406579148Pi)-292455354710356088175phi^2/(5345331795252633184Pi^2)+90671539283698726125phi^3/(668166474406579148Pi^3),Pi/9<=phi<47Pi/360},{6323095123645755775/119124537151344396672+18659963976175709675phi/(4963522381306016528Pi)+55376325825500997675phi^2/(9927044762612033056Pi^2)-22623093853669058625phi^3/(1240880595326504132Pi^3),47Pi/360<=phi<Pi/6},{-93237589241568875/2290856483679699936+8319554245948065425phi/(1527237655786466624Pi)-434295404349663825phi^2/(95452353486654164Pi^2)+59471434693430775phi^3/(29369954918970512Pi^3),Pi/6<=phi<2Pi/9},{-35492663408633225/763618827893233312+8438717854807042625phi/(1527237655786466624Pi)-935620338682502325phi^2/(190904706973308328Pi^2)+243554310241031025phi^3/(95452353486654164Pi^3),2Pi/9<=phi<Pi/4},{497266159632717325/3054475311572933248+4603296975203541275phi/(1527237655786466624Pi)+491045050559624175phi^2/(95452353486654164Pi^2)-11372739739488675phi^3/(1048926961391804Pi^3),Pi/4<=phi<5Pi/18},{-40369493560345825/81816302988560712+7713512069492966575phi/(763618827893233312Pi)-15554348490331311975phi^2/(763618827893233312Pi^2)+7549948071711105525phi^3/(381809413946616656Pi^3),5Pi/18<=phi<Pi/3},{294721233464308675/111959151458030448-178995374369007398075phi/(9927044762612033056Pi)+33452977023312675525phi^2/(522476040137475424Pi^2)-80189305494094893375phi^3/(1240880595326504132Pi^3),Pi/3<=phi<133Pi/360},{-4362460412944175/68897939358787968+2946768646803040975phi/(763618827893233312Pi)+27424522402145775phi^2/(5741494946565664Pi^2)-7458842783684854125phi^3/(668166474406579148Pi^3),133Pi/360<=phi<7Pi/18},{-3965149273308313175/1309060847816971392+5104237502845930825phi/(190904706973308328Pi)-288642391814240325phi^2/(5339991803449184Pi^2)+7495328528001846225phi^3/(190904706973308328Pi^3),7Pi/18<=phi<5Pi/12},{-1406131892034634475/572714120919924984+17262189227021298925phi/(763618827893233312Pi)-33704436146966547975phi^2/(763618827893233312Pi^2)+854434764501126075phi^3/(27272100996186904Pi^3),5Pi/12<=phi<4Pi/9},{-181392248840417625/190904706973308328+864053901581896775phi/(69419893444839392Pi)-16249844450320570575phi^2/(763618827893233312Pi^2)+5416614816773523525phi^3/(381809413946616656Pi^3),phi>=4Pi/9}}]
xn[phi_]:=Piecewise[{{-301093063832393160375/90768316619838234559-3294258706467411635250phi/(90768316619838234559Pi)-7370998796322341068500phi^2/(90768316619838234559Pi^2)-4913999197548227379000phi^3/(90768316619838234559Pi^3),phi<-4Pi/9},{1457843760831480951625/90768316619838234559+8578564860013738620750phi/(90768316619838234559Pi)+19342854228260247007500phi^2/(90768316619838234559Pi^2)+2160198652984101954000phi^3/(12966902374262604937Pi^3),-4Pi/9<=phi<-5Pi/12},{-28590017871685595750/12966902374262604937-3358847118705878256750phi/(90768316619838234559Pi)-715918040051294884500phi^2/(6982178201526018043Pi^2)-7798440428252950726800phi^3/(90768316619838234559Pi^3),-5Pi/12<=phi<-7Pi/18},{74081556333313749600/12966902374262604937+2185417888364086392150phi/(90768316619838234559Pi)+4949746926084504170100phi^2/(90768316619838234559Pi^2)+30951005682737370924000phi^3/(635378216338867641913Pi^3),-7Pi/18<=phi<-133Pi/360},{55166184547659244050/168569730865413864181-23196176483280195892050phi/(1179988116057897049267Pi)-75340352002441256588700phi^2/(1179988116057897049267Pi^2)-9793285758698868612000phi^3/(168569730865413864181Pi^3),-133Pi/360<=phi<-Pi/3},{220248505324645597950/90768316619838234559-9918362492298827550phi/(12966902374262604937Pi)-92961928714266470700phi^2/(12966902374262604937Pi^2)-9894578825142441000phi^3/(6982178201526018043Pi^3),-Pi/3<=phi<-5Pi/18},{272729667926662988575/90768316619838234559+497368018655696025900phi/(90768316619838234559Pi)+1389734100966570852600phi^2/(90768316619838234559Pi^2)+2319931597632871644000phi^3/(90768316619838234559Pi^3),-5Pi/18<=phi<-Pi/4},{251283023318891139025/90768316619838234559+240008283362433831300phi/(90768316619838234559Pi)+360295159793522074200phi^2/(90768316619838234559Pi^2)+72872795595036405600phi^3/(6982178201526018043Pi^3),-Pi/4<=phi<-2Pi/9},{18494801291820421525/6982178201526018043+93525095271887432100phi/(90768316619838234559Pi)-298879186613936722200phi^2/(90768316619838234559Pi^2)-41415176875714921800phi^3/(90768316619838234559Pi^3),-2Pi/9<=phi<-Pi/6},{3057696466252521805000/1179988116057897049267-6822898637793171750phi/(1179988116057897049267Pi)-11221324249015156122900phi^2/(1179988116057897049267Pi^2)-2172883849350321636000phi^3/(168569730865413864181Pi^3),-Pi/6<=phi<-47Pi/360},{235245194243845437100/90768316619838234559+343154492455169250phi/(90768316619838234559Pi)-856530332519503443300phi^2/(90768316619838234559Pi^2)-1153039599484226604000phi^3/(90768316619838234559Pi^3),-47Pi/360<=phi<-Pi/9},{33539754277026201700/12966902374262604937-12263531733419511150phi/(90768316619838234559Pi)-138570072650339366700phi^2/(12966902374262604937Pi^2)-1493420127582842974800phi^3/(90768316619838234559Pi^3),-Pi/9<=phi<-Pi/12},{234981072888644745025/90768316619838234559-4962985552811518650phi/(90768316619838234559Pi)-67875688798852281300phi^2/(6982178201526018043Pi^2)-1142993910913659334800phi^3/(90768316619838234559Pi^3),-Pi/12<=phi<-Pi/18},{4125000/1592779-793050214434472321200phi^2/(90768316619838234559Pi^2)-606991471210015320600phi^3/(90768316619838234559Pi^3),-Pi/18<=phi<0},{4125000/1592779-793050214434472321200phi^2/(90768316619838234559Pi^2)+606991471210015320600phi^3/(90768316619838234559Pi^3),0<=phi<Pi/18},{234981072888644745025/90768316619838234559+4962985552811518650phi/(90768316619838234559Pi)-67875688798852281300phi^2/(6982178201526018043Pi^2)+1142993910913659334800phi^3/(90768316619838234559Pi^3),Pi/18<=phi<Pi/12},{33539754277026201700/12966902374262604937+12263531733419511150phi/(90768316619838234559Pi)-138570072650339366700phi^2/(12966902374262604937Pi^2)+1493420127582842974800phi^3/(90768316619838234559Pi^3),Pi/12<=phi<Pi/9},{235245194243845437100/90768316619838234559-343154492455169250phi/(90768316619838234559Pi)-856530332519503443300phi^2/(90768316619838234559Pi^2)+1153039599484226604000phi^3/(90768316619838234559Pi^3),Pi/9<=phi<47Pi/360},{3057696466252521805000/1179988116057897049267+6822898637793171750phi/(1179988116057897049267Pi)-11221324249015156122900phi^2/(1179988116057897049267Pi^2)+2172883849350321636000phi^3/(168569730865413864181Pi^3),47Pi/360<=phi<Pi/6},{18494801291820421525/6982178201526018043-93525095271887432100phi/(90768316619838234559Pi)-298879186613936722200phi^2/(90768316619838234559Pi^2)+41415176875714921800phi^3/(90768316619838234559Pi^3),Pi/6<=phi<2Pi/9},{251283023318891139025/90768316619838234559-240008283362433831300phi/(90768316619838234559Pi)+360295159793522074200phi^2/(90768316619838234559Pi^2)-72872795595036405600phi^3/(6982178201526018043Pi^3),2Pi/9<=phi<Pi/4},{272729667926662988575/90768316619838234559-497368018655696025900phi/(90768316619838234559Pi)+1389734100966570852600phi^2/(90768316619838234559Pi^2)-2319931597632871644000phi^3/(90768316619838234559Pi^3),Pi/4<=phi<5Pi/18},{220248505324645597950/90768316619838234559+9918362492298827550phi/(12966902374262604937Pi)-92961928714266470700phi^2/(12966902374262604937Pi^2)+9894578825142441000phi^3/(6982178201526018043Pi^3),5Pi/18<=phi<Pi/3},{55166184547659244050/168569730865413864181+23196176483280195892050phi/(1179988116057897049267Pi)-75340352002441256588700phi^2/(1179988116057897049267Pi^2)+9793285758698868612000phi^3/(168569730865413864181Pi^3),Pi/3<=phi<133Pi/360},{74081556333313749600/12966902374262604937-2185417888364086392150phi/(90768316619838234559Pi)+4949746926084504170100phi^2/(90768316619838234559Pi^2)-30951005682737370924000phi^3/(635378216338867641913Pi^3),133Pi/360<=phi<7Pi/18},{-28590017871685595750/12966902374262604937+3358847118705878256750phi/(90768316619838234559Pi)-715918040051294884500phi^2/(6982178201526018043Pi^2)+7798440428252950726800phi^3/(90768316619838234559Pi^3),7Pi/18<=phi<5Pi/12},{1457843760831480951625/90768316619838234559-8578564860013738620750phi/(90768316619838234559Pi)+19342854228260247007500phi^2/(90768316619838234559Pi^2)-2160198652984101954000phi^3/(12966902374262604937Pi^3),5Pi/12<=phi<4Pi/9},{-301093063832393160375/90768316619838234559+3294258706467411635250phi/(90768316619838234559Pi)-7370998796322341068500phi^2/(90768316619838234559Pi^2)+4913999197548227379000phi^3/(90768316619838234559Pi^3),phi>=4Pi/9}}]
rho[phi_]:=(xn[phi]^2+(yn[phi]-y0[phi])^2)/(2(yn[phi]-y0[phi]))
deltaPhiN[phi_]:=ArcSin[xn[phi]/rho[phi]]
deltaPhi[lambda_,phi_]:=deltaPhiN[phi]b(1-c Abs[lambda])lambda/lambdaN
y[lambda_,phi_]:=Piecewise[{{0,phi==0},{y0[phi]+rho[phi](1-Cos[deltaPhi[lambda,phi]]),phi!=0}}]
x[lambda_,phi_]:=Piecewise[{{xn[phi]b(1-c Abs[lambda])lambda/lambdaN,phi==0},{rho[phi]Sin[deltaPhi[lambda,phi]],phi!=0}}]
