(*
data for interpolation, todo: piecewise function should be updated!
{{-Pi/2,-4Pi/9,-5Pi/12,-7Pi/18,-221869Pi/600000,-Pi/3,-5Pi/18,-Pi/4,-2Pi/9,-Pi/6,-78131Pi/600000,-Pi/9,-Pi/12,-Pi/18,0,Pi/18,Pi/12,Pi/9,78131Pi/600000,Pi/6,2Pi/9,Pi/4,5Pi/18,Pi/3,221869Pi/600000,7Pi/18,5Pi/12,4Pi/9,Pi/2},{-2750000/1592779,-2586250/1592779,-2496525/1592779,-2394300/1592779,-2311750/1592779,-2138775/1592779,-1854975/1592779,-1701800/1592779,-1540825/1592779,-1194900/1592779,-953125/1592779,-817925/1592779,-614075/1592779,-415975/1592779,0,415975/1592779,614075/1592779,817925/1592779,953125/1592779,1194900/1592779,1540825/1592779,1701800/1592779,1854975/1592779,2138775/1592779,2311750/1592779,2394300/1592779,2496525/1592779,2586250/1592779,2750000/1592779},{2062500/1592779,2429125/1592779,2592250/1592779,2758700/1592779,2874475/1592779,3085800/1592779,3370575/1592779,3491950/1592779,3603325/1592779,3803200/1592779,3916075/1592779,3969550/1592779,4034725/1592779,4083875/1592779,4125000/1592779,4083875/1592779,4034725/1592779,3969550/1592779,3916075/1592779,3803200/1592779,3603325/1592779,3491950/1592779,3370575/1592779,3085800/1592779,2874475/1592779,2758700/1592779,2592250/1592779,2429125/1592779,2062500/1592779}}
*)

b=11/10
lambdaN=Pi
c=(1-1/b)/lambdaN
y0[phi_]:=9953537phi/10000000+738069phi^3/50000000
yn[phi_]:=Piecewise[{{35231136301697507553218000441000/34347901705957678636706033615139+886437576156585948619450309278725phi/(68695803411915357273412067230278Pi)+6275316512818786645429346376725phi^2/(282698779472902704828856243746Pi^2)+6275316512818786645429346376725phi^3/(424048169209354057243284365619Pi^3),phi<-4Pi/9},{177746419201765389176022261903800/103043705117873035910118100845417+1210676122491613847943107481892325phi/(68695803411915357273412067230278Pi)+27832575825540468250834071702775phi^2/(848096338418708114486568731238Pi^2)+9652801370475327263384108591450phi^3/(424048169209354057243284365619Pi^3),-4Pi/9<=phi<-5Pi/12},{4522146157268193055164565972971025/824349640942984287280944806763336+37448548837610436743865124494350phi/(837753700145309235041610575979Pi)+6380522658243721409731014579175phi^2/(65238179878362162652812979326Pi^2)+31698488863126491293651755722050phi^3/(424048169209354057243284365619Pi^3),-5Pi/12<=phi<-7Pi/18},{-6344342250246320294356517807460332525/1313751948508671617444493039481052136-156523259722899195578333088270572085475phi/(4488652490737961359602017884893594798Pi)-5918940523822920879239896630636486675phi^2/(55415462848616806908666887467822158Pi^2)-2788260622187106169869475574080750000phi^3/(27707731424308403454333443733911079Pi^3),-7Pi/18<=phi<-22187Pi/60000},{-15283685680321526258305916254635965050/12845325236288934783519412333288837803-803068466498461480447266794372803325phi/(150237722061858886356952191032617986Pi)-25657062041930370548265731935190869925phi^2/(951505573058439613594030543206580578Pi^2)-13633194409627157568243419365773250000phi^3/(475752786529219806797015271603290289Pi^3),-22187Pi/60000<=phi<-Pi/3},{28960829472094653865660715450075/103043705117873035910118100845417+3433855598155156119584295331621775phi/(435073421608797262731609759125094Pi)+5546760585750515263294421046485075phi^2/(435073421608797262731609759125094Pi^2)+267272230445369920555905909472825phi^3/(24170745644933181262867208840283Pi^3),-Pi/3<=phi<-5Pi/18},{-64011076308346766529973605143675/580097895478396350308813012166792+3189504112260062188834761010869175phi/(870146843217594525463219518250188Pi)-537006082769967413653236163894400phi^2/(217536710804398631365804879562547Pi^2)-174112619640660085484153648812100phi^3/(24170745644933181262867208840283Pi^3),-5Pi/18<=phi<-Pi/4},{23042112976823293691569070388025/145024473869599087577203253041698+6000735620141581132167258971393125phi/(870146843217594525463219518250188Pi)+2274225425111551529679261796629550phi^2/(217536710804398631365804879562547Pi^2)+242366122267713091305846049043300phi^3/(24170745644933181262867208840283Pi^3),-Pi/4<=phi<-2Pi/9},{-302361279886796660852878779954125/3915660794479175364584487832125846+3227240629358504360591527930100725phi/(870146843217594525463219518250188Pi)-845956439519409838343435624824400phi^2/(217536710804398631365804879562547Pi^2)-277664188504113803364603521199025phi^3/(24170745644933181262867208840283Pi^3),-2Pi/9<=phi<-Pi/6},{1160552946780178165707126667490123275/7904815530023959866781176820485438648+11049070876678138707864153031969628950phi/(1427258359587659420391045814809870867Pi)+19322144271033509088701409955505733475phi^2/(951505573058439613594030543206580578Pi^2)+17557093515164935729990106270727250000phi^3/(475752786529219806797015271603290289Pi^3),-Pi/6<=phi<-7813Pi/60000},{68774636227196043348380347044999875/1035842882477991082985081050360060338+13216123200097321529536925756507925650phi/(2244326245368980679801008942446797399Pi)+336840186653520105910583228329890725phi^2/(55415462848616806908666887467822158Pi^2)+13335071765646809080329377974750000phi^3/(27707731424308403454333443733911079Pi^3),-7813Pi/60000<=phi<-Pi/9},{-1460399462835852906549896747075/10846705801881372201065063246886+15825565717656444745086680153300phi/(34347901705957678636706033615139Pi)-1170181321228443874931572651325phi^2/(27357946400603487564082862298Pi^2)-61942015453507962566674466030450phi^3/(424048169209354057243284365619Pi^3),-Pi/9<=phi<-Pi/12},{23496169615872688497051968278225/824349640942984287280944806763336+435110717809505417674705723474375phi/(68695803411915357273412067230278Pi)+23496169615872688497051968278225phi^2/(848096338418708114486568731238Pi^2)+57601565694400934673186974908150phi^3/(424048169209354057243284365619Pi^3),-Pi/12<=phi<-Pi/18},{658755909076156638875943732444725phi/(137391606823830714546824134460556Pi)-12886943153217130817968929926525phi^3/(424048169209354057243284365619Pi^3),-Pi/18<=phi<Pi/18},{-23496169615872688497051968278225/824349640942984287280944806763336+435110717809505417674705723474375phi/(68695803411915357273412067230278Pi)-23496169615872688497051968278225phi^2/(848096338418708114486568731238Pi^2)+57601565694400934673186974908150phi^3/(424048169209354057243284365619Pi^3),Pi/18<=phi<Pi/12},{1460399462835852906549896747075/10846705801881372201065063246886+15825565717656444745086680153300phi/(34347901705957678636706033615139Pi)+1170181321228443874931572651325phi^2/(27357946400603487564082862298Pi^2)-61942015453507962566674466030450phi^3/(424048169209354057243284365619Pi^3),Pi/12<=phi<Pi/9},{-68774636227196043348380347044999875/1035842882477991082985081050360060338+13216123200097321529536925756507925650phi/(2244326245368980679801008942446797399Pi)-336840186653520105910583228329890725phi^2/(55415462848616806908666887467822158Pi^2)+13335071765646809080329377974750000phi^3/(27707731424308403454333443733911079Pi^3),Pi/9<=phi<7813Pi/60000},{-1160552946780178165707126667490123275/7904815530023959866781176820485438648+11049070876678138707864153031969628950phi/(1427258359587659420391045814809870867Pi)-19322144271033509088701409955505733475phi^2/(951505573058439613594030543206580578Pi^2)+17557093515164935729990106270727250000phi^3/(475752786529219806797015271603290289Pi^3),7813Pi/60000<=phi<Pi/6},{302361279886796660852878779954125/3915660794479175364584487832125846+3227240629358504360591527930100725phi/(870146843217594525463219518250188Pi)+845956439519409838343435624824400phi^2/(217536710804398631365804879562547Pi^2)-277664188504113803364603521199025phi^3/(24170745644933181262867208840283Pi^3),Pi/6<=phi<2Pi/9},{-23042112976823293691569070388025/145024473869599087577203253041698+6000735620141581132167258971393125phi/(870146843217594525463219518250188Pi)-2274225425111551529679261796629550phi^2/(217536710804398631365804879562547Pi^2)+242366122267713091305846049043300phi^3/(24170745644933181262867208840283Pi^3),2Pi/9<=phi<Pi/4},{64011076308346766529973605143675/580097895478396350308813012166792+3189504112260062188834761010869175phi/(870146843217594525463219518250188Pi)+537006082769967413653236163894400phi^2/(217536710804398631365804879562547Pi^2)-174112619640660085484153648812100phi^3/(24170745644933181262867208840283Pi^3),Pi/4<=phi<5Pi/18},{-28960829472094653865660715450075/103043705117873035910118100845417+3433855598155156119584295331621775phi/(435073421608797262731609759125094Pi)-5546760585750515263294421046485075phi^2/(435073421608797262731609759125094Pi^2)+267272230445369920555905909472825phi^3/(24170745644933181262867208840283Pi^3),5Pi/18<=phi<Pi/3},{15283685680321526258305916254635965050/12845325236288934783519412333288837803-803068466498461480447266794372803325phi/(150237722061858886356952191032617986Pi)+25657062041930370548265731935190869925phi^2/(951505573058439613594030543206580578Pi^2)-13633194409627157568243419365773250000phi^3/(475752786529219806797015271603290289Pi^3),Pi/3<=phi<22187Pi/60000},{6344342250246320294356517807460332525/1313751948508671617444493039481052136-156523259722899195578333088270572085475phi/(4488652490737961359602017884893594798Pi)+5918940523822920879239896630636486675phi^2/(55415462848616806908666887467822158Pi^2)-2788260622187106169869475574080750000phi^3/(27707731424308403454333443733911079Pi^3),22187Pi/60000<=phi<7Pi/18},{-4522146157268193055164565972971025/824349640942984287280944806763336+37448548837610436743865124494350phi/(837753700145309235041610575979Pi)-6380522658243721409731014579175phi^2/(65238179878362162652812979326Pi^2)+31698488863126491293651755722050phi^3/(424048169209354057243284365619Pi^3),7Pi/18<=phi<5Pi/12},{-177746419201765389176022261903800/103043705117873035910118100845417+1210676122491613847943107481892325phi/(68695803411915357273412067230278Pi)-27832575825540468250834071702775phi^2/(848096338418708114486568731238Pi^2)+9652801370475327263384108591450phi^3/(424048169209354057243284365619Pi^3),5Pi/12<=phi<4Pi/9},{-35231136301697507553218000441000/34347901705957678636706033615139+886437576156585948619450309278725phi/(68695803411915357273412067230278Pi)-6275316512818786645429346376725phi^2/(282698779472902704828856243746Pi^2)+6275316512818786645429346376725phi^3/(424048169209354057243284365619Pi^3),phi>=4Pi/9}}]
xn[phi_]:=Piecewise[{{-324323515301279336159601072369625/100809306890446240817252560707921-3597710231918907055275267919232750phi/(100809306890446240817252560707921Pi)-33185011514089225461007573038500phi^2/(414853114775498933404331525547Pi^2)-66370023028178450922015146077000phi^3/(1244559344326496800212994576641Pi^3),phi<-4Pi/9},{4565104319688964307389435084395125/302427920671338722451757682123763+8862958215664898155428268259151250phi/(100809306890446240817252560707921Pi)+246574644557282468358742174728500phi^2/(1244559344326496800212994576641Pi^2)+27603890899497736804901217758000phi^3/(177794192046642400030427796663Pi^3),-4Pi/9<=phi<-5Pi/12},{45191785842402199792289170537250/43203988667334103207393954589109-1334070149436259225795917878371250phi/(100809306890446240817252560707921Pi)-55559529223492565159011488605500phi^2/(1244559344326496800212994576641Pi^2)-48480102728135869179894406361200phi^3/(1244559344326496800212994576641Pi^3),-5Pi/12<=phi<-7Pi/18},{-2103671707171464964658565333434327300/2822991823512277637674328386806971169-178187344980512221895888646549813878150phi/(6586980921528647821240099569216266061Pi)-6519771305220723186504416548691278100phi^2/(81320752117637627422717278632299581Pi^2)-5644415054840693387897292010378000000phi^3/(81320752117637627422717278632299581Pi^3),-7Pi/18<=phi<-22187Pi/60000},{84804972738753742297173142164472422850/37700362162968413802113660895866171817-607693841365066355111596952479467050phi/(220469954169405928667331350268223227Pi)-20208306078178828192432490296589497100phi^2/(1396309709739570881559765218365413771Pi^2)-14220893896043052681598457086598000000phi^3/(1396309709739570881559765218365413771Pi^3),-22187Pi/60000<=phi<-Pi/3},{1217583466210001003400595208650/569544106725684976368658535073-7203713859538773450052915620696850phi/(1915376830918478575527798653450499Pi)-11164446869251881564050239900294300phi^2/(638458943639492858509266217816833Pi^2)-936302043434338742556716021539000phi^3/(70939882626610317612140690868537Pi^3),-Pi/3<=phi<-5Pi/18},{5966034531941752780578011958893075/1915376830918478575527798653450499+1858048651328348019468376474156700phi/(273625261559782653646828379064357Pi)+13087618433352769939547621227458200phi^2/(638458943639492858509266217816833Pi^2)+2297306663579614791256332128828000phi^3/(70939882626610317612140690868537Pi^3),-5Pi/18<=phi<-Pi/4},{766334250411676020349221425942075/273625261559782653646828379064357+5786003210578188478677091591514300phi/(1915376830918478575527798653450499Pi)+3460501968392439729412229590681400phi^2/(638458943639492858509266217816833Pi^2)+871067187289195500865903738194400phi^3/(70939882626610317612140690868537Pi^3),-Pi/4<=phi<-2Pi/9},{14939831871329625792957665833661975/5746130492755435726583395960351497+596659967658120623985163091467100phi/(1915376830918478575527798653450499Pi)-4323512895987662052625663159389400phi^2/(638458943639492858509266217816833Pi^2)-426268623440821462807078386817400phi^3/(70939882626610317612140690868537Pi^3),-2Pi/9<=phi<-Pi/6},{100842646437246849678611536553455328500/37700362162968413802113660895866171817+6949714408174659506688133718636768750phi/(4188929129218712644679295655096241313Pi)+1834115414287682494972838745611824300phi^2/(1396309709739570881559765218365413771Pi^2)+2027004417205672850814086323238000000phi^3/(199472815677081554508537888337916253Pi^3),-Pi/6<=phi<-7813Pi/60000},{16439679056954624158068210644237194900/6586980921528647821240099569216266061-22284200743875139592932953413256250phi/(9035639124181958602524142070255509Pi)-22225139759545036472233035824648824300phi^2/(731886769058738646804455507690696229Pi^2)-5768484849861966076697694578074000000phi^3/(81320752117637627422717278632299581Pi^3),-7813Pi/60000<=phi<-Pi/9},{37473993139384489457144483032300/14401329555778034402464651529703+167947677916027799896854407050phi/(414853114775498933404331525547Pi)-7243990747750252626400060299700phi^2/(1600147728419781600273850169967Pi^2)+8194844553026397127422331614800phi^3/(1244559344326496800212994576641Pi^3),-Pi/9<=phi<-Pi/12},{260863195725846884741941847167975/100809306890446240817252560707921-428145898548471745021022414050phi/(3733678032979490400638983729923Pi)-120536235226789758372138056887900phi^2/(11201034098938471201916951189769Pi^2)-22839955443657153978061061625200phi^3/(1244559344326496800212994576641Pi^3),-Pi/12<=phi<-Pi/18},{4125000/1592779-97416356705172284141002846529200phi^2/(11201034098938471201916951189769Pi^2)-7426703095912171157304254719400phi^3/(1244559344326496800212994576641Pi^3),-Pi/18<=phi<0},{4125000/1592779-97416356705172284141002846529200phi^2/(11201034098938471201916951189769Pi^2)+7426703095912171157304254719400phi^3/(1244559344326496800212994576641Pi^3),0<=phi<Pi/18},{260863195725846884741941847167975/100809306890446240817252560707921+428145898548471745021022414050phi/(3733678032979490400638983729923Pi)-120536235226789758372138056887900phi^2/(11201034098938471201916951189769Pi^2)+22839955443657153978061061625200phi^3/(1244559344326496800212994576641Pi^3),Pi/18<=phi<Pi/12},{37473993139384489457144483032300/14401329555778034402464651529703-167947677916027799896854407050phi/(414853114775498933404331525547Pi)-7243990747750252626400060299700phi^2/(1600147728419781600273850169967Pi^2)-8194844553026397127422331614800phi^3/(1244559344326496800212994576641Pi^3),Pi/12<=phi<Pi/9},{16439679056954624158068210644237194900/6586980921528647821240099569216266061+22284200743875139592932953413256250phi/(9035639124181958602524142070255509Pi)-22225139759545036472233035824648824300phi^2/(731886769058738646804455507690696229Pi^2)+5768484849861966076697694578074000000phi^3/(81320752117637627422717278632299581Pi^3),Pi/9<=phi<7813Pi/60000},{100842646437246849678611536553455328500/37700362162968413802113660895866171817-6949714408174659506688133718636768750phi/(4188929129218712644679295655096241313Pi)+1834115414287682494972838745611824300phi^2/(1396309709739570881559765218365413771Pi^2)-2027004417205672850814086323238000000phi^3/(199472815677081554508537888337916253Pi^3),7813Pi/60000<=phi<Pi/6},{14939831871329625792957665833661975/5746130492755435726583395960351497-596659967658120623985163091467100phi/(1915376830918478575527798653450499Pi)-4323512895987662052625663159389400phi^2/(638458943639492858509266217816833Pi^2)+426268623440821462807078386817400phi^3/(70939882626610317612140690868537Pi^3),Pi/6<=phi<2Pi/9},{766334250411676020349221425942075/273625261559782653646828379064357-5786003210578188478677091591514300phi/(1915376830918478575527798653450499Pi)+3460501968392439729412229590681400phi^2/(638458943639492858509266217816833Pi^2)-871067187289195500865903738194400phi^3/(70939882626610317612140690868537Pi^3),2Pi/9<=phi<Pi/4},{5966034531941752780578011958893075/1915376830918478575527798653450499-1858048651328348019468376474156700phi/(273625261559782653646828379064357Pi)+13087618433352769939547621227458200phi^2/(638458943639492858509266217816833Pi^2)-2297306663579614791256332128828000phi^3/(70939882626610317612140690868537Pi^3),Pi/4<=phi<5Pi/18},{1217583466210001003400595208650/569544106725684976368658535073+7203713859538773450052915620696850phi/(1915376830918478575527798653450499Pi)-11164446869251881564050239900294300phi^2/(638458943639492858509266217816833Pi^2)+936302043434338742556716021539000phi^3/(70939882626610317612140690868537Pi^3),5Pi/18<=phi<Pi/3},{84804972738753742297173142164472422850/37700362162968413802113660895866171817+607693841365066355111596952479467050phi/(220469954169405928667331350268223227Pi)-20208306078178828192432490296589497100phi^2/(1396309709739570881559765218365413771Pi^2)+14220893896043052681598457086598000000phi^3/(1396309709739570881559765218365413771Pi^3),Pi/3<=phi<22187Pi/60000},{-2103671707171464964658565333434327300/2822991823512277637674328386806971169+178187344980512221895888646549813878150phi/(6586980921528647821240099569216266061Pi)-6519771305220723186504416548691278100phi^2/(81320752117637627422717278632299581Pi^2)+5644415054840693387897292010378000000phi^3/(81320752117637627422717278632299581Pi^3),22187Pi/60000<=phi<7Pi/18},{45191785842402199792289170537250/43203988667334103207393954589109+1334070149436259225795917878371250phi/(100809306890446240817252560707921Pi)-55559529223492565159011488605500phi^2/(1244559344326496800212994576641Pi^2)+48480102728135869179894406361200phi^3/(1244559344326496800212994576641Pi^3),7Pi/18<=phi<5Pi/12},{4565104319688964307389435084395125/302427920671338722451757682123763-8862958215664898155428268259151250phi/(100809306890446240817252560707921Pi)+246574644557282468358742174728500phi^2/(1244559344326496800212994576641Pi^2)-27603890899497736804901217758000phi^3/(177794192046642400030427796663Pi^3),5Pi/12<=phi<4Pi/9},{-324323515301279336159601072369625/100809306890446240817252560707921+3597710231918907055275267919232750phi/(100809306890446240817252560707921Pi)-33185011514089225461007573038500phi^2/(414853114775498933404331525547Pi^2)+66370023028178450922015146077000phi^3/(1244559344326496800212994576641Pi^3),phi>=4Pi/9}}]
rho[phi_]:=(xn[phi]^2+(yn[phi]-y0[phi])^2)/(2(yn[phi]-y0[phi]))
deltaPhiN[phi_]:=ArcSin[xn[phi]/rho[phi]]
deltaPhi[lambda_,phi_]:=deltaPhiN[phi]b(1-c Abs[lambda])lambda/lambdaN
y[lambda_,phi_]:=Piecewise[{{0,phi==0},{y0[phi]+rho[phi](1-Cos[deltaPhi[lambda,phi]]),phi!=0}}]
x[lambda_,phi_]:=Piecewise[{{xn[phi]b(1-c Abs[lambda])lambda/lambdaN,phi==0},{rho[phi]Sin[deltaPhi[lambda,phi]],phi!=0}}]
