## 符号约定
### 函数记号
floor(x)（纯文本用）或 $\lfloor x\rfloor$（TeX 环境用）表示对 $x$ 向下取整。

### 旋转矩阵
$R_1(\varphi)=\left\[\begin{matrix}1 & 0 & 0\cr0 & \cos\varphi & \sin\varphi\cr0 & -\sin\varphi & \cos\varphi\end{matrix}\right\]$（表示标架绕 $x$ 轴旋转 $\varphi$，或地球绕 $x$ 轴旋转 $-\varphi$）

$R_2(\varphi)=\left\[\begin{matrix}\cos\varphi & 0 & -\sin\varphi\cr0 & 1 & 0\cr\sin\varphi & 0 & \cos\varphi\end{matrix}\right\]$（表示标架绕 $y$ 轴旋转 $\varphi$，或地球绕 $y$ 轴旋转 $-\varphi$）

$R_3(\varphi)=\left\[\begin{matrix}\cos\varphi & \sin\varphi & 0\cr-\sin\varphi & \cos\varphi & 0\cr0 & 0 & 1\end{matrix}\right\]$（表示标架绕 $z$ 轴旋转 $\varphi$，或地球绕 $z$ 轴旋转 $-\varphi$）

### 单位
单位约定与国际单位制（法 Système international d'unités, SI、英 International System of Units）规范文本一致，以下提及部分。

$\text{s}$ 表示秒（英 second、法 seconde），定义为 $1\kern{3 mu}\text{s}=\dfrac{9192631770}{\Delta\nu_\text{Cs}}$（其中 $\Delta\nu_\text{Cs}$ 是铯-133 原子不受扰动的基态超精细能级跃迁频率），是量纲时间（英 time、法 temps，符号为 $\text{T}$）对应的基本单位。

$\text{m}$ 表示米（英 metre、法 mètre），定义为 $1\kern{3 mu}\text{m}=\dfrac{c}{299792458}\kern{3 mu}\text{s}$（其中 $c$ 是真空光速），是量纲长度（英 length、法 longueur，符号为 $\text{L}$）对应的基本单位。

$\text{rad}$ 表示弧度（英 radian、法 radian），定义为 $\text{rad}=\kern{0 mu}^\text{m}\kern{-3 mu}/\kern{-3 mu}\_\text{m}$，用于度量平面角（英 plane angle、法 angle plan）。

$\text{Hz}$ 表示赫兹（英 hertz、法 hertz），定义为 $\text{Hz}=\text{s}^{-1}$，用于度量频率（英 frequency、法 fréquence）。

$\text{min}$ 表示分（英 minute、法 minute），定义为 $1\kern{3 mu}\text{min}=60\kern{3 mu}\text{s}$，用于度量时间。

$\text{h}$ 表示（小）时（英 hour、法 heure），定义为 $1\kern{3 mu}\text{h}=60\kern{3 mu}\text{min}=3600\kern{3 mu}\text{s}$，用于度量时间。

$\text{d}$ 表示天（日）（英 day、法 jour），定义为 $1\kern{3 mu}\text{d}=24\kern{3 mu}\text{h}=86400\kern{3 mu}\text{s}$，用于度量时间。

$^\circ$ 表示度（英 degree、法 degré），定义为 $1^\circ=\dfrac{\pi}{180}\kern{3 mu}\text{rad}$，用于度量平面角。

$'$ 表示（角）分（英 (arc)minute、法 (arc)minute），定义为 $1'=\dfrac{1}{60}^\circ=\dfrac{\pi}{10800}\kern{3 mu}\text{rad}$，用于度量平面角。

$''$ 或 $\text{as}$ 表示（角）秒（英 (arc)second、法 (arc)seconde），定义为 $1''=1\kern{3 mu}\text{as}=\dfrac{1}{60}'=\dfrac{\pi}{648000}\kern{3 mu}\text{rad}$，用于度量平面角。

$\mu\text{as}$ 表示微角秒（英 microarcsecond、法 microarcseconde），定义为 $1\kern{3 mu}\mu\text{as}=10^{-6}\kern{3 mu}\text{as}=\dfrac{\pi}{648000000000}\kern{3 mu}\text{rad}$，用于度量平面角。

### 日期
日期未作说明时总以（倒推）公历理解。

### 时刻标度
时刻标度未作说明时总以零时区理解。

## Julius 日数及其衍生
### Julius 日数
从零时区的倒推 Julius 历公元前 4713 年 1 月 1 日（即倒推公历公元前 4714 年 11 月 24 日）正午（12:00:00）起算的整天数称为 Julius 日数（英 Julian day number, JDN）。

「整天数」仍不够明确，需要给出确切的阐述：JDN 在且仅在每天的 12:00:00 改变，幅度为 1；时刻标度到 JDN 的函数不减且右连续；公元前 4714 年 11 月 24 日 12:00:00 的 JDN 为 0。

例如，当且仅当时刻位于区间 \[公元前 4714 年 11 月 24 日 12:00:00, 公元前 4714 年 11 月 25 日 12:00:00) 内时 JDN 为 0。

### Julius 日
令当前 JDN 对应的起始时刻为 0，下一 JDN 对应的起始时刻为 1 作关于时刻标度的一次函数，则该函数即给出 $\[0,1)$ 范围内的实数。将其加上 JDN，得到的实数便是 Julius 日（英 Julian date, JD）。

可以看出，JD 的整数部分是 JDN，而小数部分对应的是一天内的进度。当且仅当时刻为某天的 12:00:00 时 JD 为整数。

### 约化 Julius 日
JD 有两个问题：一个是起点过于久远，于是表示当今时刻数值就显得较大；另一个是整数对应的时刻是 12:00:00 而非 00:00:00，整数部分就与对应时刻下的日期部分并不一致。

前者可以减去大整数解决，后者可以减去 0.5 解决。因此将 JD 减去 2400000.5，得到约化 Julius 日（英 Modified Julian date, MJD）。

$\text{MJD}=\text{JD}-2400000.5$

最后强调，JD 这类表示法必须指明时间尺度才能解读意义。因为这类表示法是时刻标度到实数的双射，而时刻与其标度的具体关系取决于时间尺度——同一时刻依时间尺度不同其标度可能不同，同一时刻标度依时间尺度不同其时刻也可能不同。

## 因研究地球而生的参考系
### 天球参考系与地球参考系
天球参考系（英 Celestial reference system, CRS）是标架相对于宇宙遥远物质固定的准惯性参考系，地球参考系（英 Terrestrial reference system, TRS）是标架随地球一同旋转的参考系。

当然，这种概念约束不过限定在标架上面而已，对原点的情形则没有限制。

### 按原点分类
如果将常见的 CRS 与 TRS 按原点分类，则可以细分为三种：
- 质心天球参考系（英 Barycentric Celestial Reference System, BCRS）
- 地心天球参考系（英 Geocentric Celestial Reference System, GCRS）
- 地心地球参考系（英 Geocentric Terrestrial Reference System, GTRS）

质心地球参考系就不太有用的必要。

### 协议天球参考系与协议地球参考系
出于交流的需要，自然需要约定参考系的参数来共同应用。由此得到协议天球参考系（英 Conventional celestial reference system, CCRS）与协议地球参考系（英 Conventional terrestrial reference system, CTRS）。

就「协议」而言倒不见得世界通用，只有两方用也能叫协议。

### 国际天球参考系与国际地球参考系
国际地球自转和参考系服务（英 International Earth Rotation and Reference Systems Service, IERS）在 CRS 方面提出了国际天球参考系（英 International Celestial Reference System, ICRS）并被国际天文学联合会（英 International Astronomical Union, IAU、法 Union astronomique internationale, UAI）采用，在 TRS 方面提出了国际地球参考系（英 International Terrestrial Reference System, ITRS）。

于是，ICRS 与 ITRS 就各成为世界范围内通用的 CCRS 与 CTRS。

ICRS 与 ITRS 各是特殊的 BCRS 与 GTRS。

需要指出，如果没有特别说明，使用术语 BCRS 与 GCRS 时总是默认标架定向与 ICRS 一致——这是 IAU 2006 决议 B2 的规定。

### 在 ITRS 与 GCRS 间转换
这里介绍 ITRS 转至 GCRS 的过程，反过来的情形施逆变换即可。

本节中时刻参数定义为 $t=\dfrac{\text{TT}-\text{J2000.0}}{36525\kern{3 mu}\text{d}}$。

TT 是后续章节将提到的地球时，J2000.0 是地球时的 2000 年 1 月 1 日 12:00:00（以 JD 计便为 2451545.0）。

了解这样的约定，便可用 JD 更明确地表述时刻参数。

$t=\dfrac{\text{JD}\_\text{TT}-2451545.0}{36525}$

另外约定 $t_0$ 代表 J2000.0 时的 $t$，于是 $t_0=0$。

#### 极移
第一步，将 ITRS 变换至地球中间参考系（英 Terrestrial Intermediate Reference System, TIRS）。

TIRS 的 $z$ 轴指向天球中间极（英 Celestial Intermediate Pole, CIP），且 $x$ 轴指向地球中间零点（英 Terrestrial Intermediate Origin, TIO）。

$\text{\[TIRS\]}=W(t)\text{\[ITRS\]}$

$W(t)$ 的定义如下。

$W(t)=R_3(-s')R_2(x_p)R_1(y_p)$

$(x_p,y_p)$ 是 ITRS 中 CIP 的极点坐标。$x_p$ 与 $y_p$ 之正向依照 IERS 约定，分别指向 0° 与 90°W 经线。

这样 $z$ 轴的确指向了 CIP；但是就这一个条件并不足以确定参考系，因为 $x$ 轴与 $y$ 轴的方向未定。

因此还要用到 $x$ 轴指向 TIO 的条件。$s'$ 是 TIO 定位角，用来将 $x$ 轴旋转至 TIO。其定义如下。

$\displaystyle s'(t)=\dfrac{1}{2}\left.\int_{t_0}^{T}\left(x_p\dfrac{dy_p}{dt}-\dfrac{dx_p}{dt}y_p\right)dt\right\|\_{T=t}$

这样就把极移处理完了。

#### 自转
让 $z$ 轴指向 CIP 后，$z$ 轴也就成了地球的自转轴。

第二步，将 TIRS 变换至天球中间参考系（英 Celestial Intermediate Reference System, CIRS）。

CIRS 的 $z$ 轴指向 CIP，且 $x$ 轴指向天球中间零点（英 Celestial Intermediate Origin, CIO）。

$\text{\[CIRS\]}=R(t)\text{\[TIRS\]}$

$R(t)$ 的定义如下。

$R(t)=R_3(-\text{ERA})$

$\text{ERA}$ 是地球自转角，即 CIO 与 TIO 在 CIP 赤道上的夹角。注意到 R_3 的变量是 $\text{ERA}$ 的相反数——正如最开始的符号约定所言，$R_3(\varphi)$ 表示地球绕 $z$ 轴旋转 $-\varphi$。

自转也处理完了。

#### 岁差和章动
设 $(X,Y,Z)$ 是 GCRS 下原点到 CIP 的方向向量。

第三步，将 CIRS 变换至 GCRS。

$\text{\[GCRS\]}=Q(t)\text{\[CIRS\]}$

$Q(t)$ 的定义如下。

$Q(t)=R_3(-E)R_2(-d)R_3(E)R_3(s)$

$d$ 与 $E$ 可以依下式确定。

$(X,Y,Z)=(\sin d\cos E,\sin d\sin E,\cos d)$

虽说就是个球坐标的反解……

$s$ 是 CIO 定位角。其定义如下。

$\displaystyle s(t)=-\left.\int_{t_0}^{T}\dfrac{X(t)\dfrac{dY(t)}{dt}-Y(t)\dfrac{dX(t)}{dt}}{1+Z(t)}dt\right\|\_{T=t}-\left(\sigma_0N_0-\Sigma_0N_0\right)$

需要注意的是，天文学约定 $AB$ 表示以地心为顶点，两边各过 $A$ 与 $B$ 两点的角的大小，称其为 $A$ 与 $B$ 相对于地心的角距离。

其中 $\sigma_0$ 是 $t_0$ 时的 CIO，$\Sigma_0$ 是 GCRS 的 $x$ 零点，$N_0$ 是 $t_0$ 时 CIP 赤道在 GCRS 赤道上的升交点。

$t_0$ 依照 IERS 约定而同节首所言，代表 J2000.0 时的 $t$。IERS 还约定，该算法在其强制实施时点（2003 年 1 月 1 日）的计算结果应当同旧算法保持一致。由是，经过计算，积分常数 $s_0=-(\sigma_0N_0-\Sigma_0N_0)$ 确定为 $+94\kern{3 mu}\mu\text{as}$。

岁差和章动也处理了。

因此总变换可以写成下式。

$\text{\[GCRS\]}=Q(t)R(t)W(t)\text{\[ITRS\]}$

## 世界时
### 太阳日与恒星日
观察太阳照射的变化以感知并测量时间流逝是自古以来便为人——其实植物也会——采用的方法，典例有日晷。太阳经过地方经线的时刻称为太阳正午，此时太阳高度角达到极大值。相邻太阳正午之间的时间是一个太阳日。

直接观测得到的太阳日便是视太阳日。

不过中学物理和中学地理都有讲到 Kepler 三定律，也就能看出地球公转的速率并不均匀。而且地轴有着约 23 度 26 分的倾角（黄赤交角），于是日影的运行速率也不均匀。这样视太阳日便有不小的波动。

如果太阳相对地球在赤道面上匀速率转动就好了……那就假想一个这样的太阳，然后让公转周期和真正的太阳保持一致不就行了吗？这样假想出来的太阳称作平太阳，按平太阳计算的太阳日就是平太阳日。

从历史的角度来看，「天」最初指地球自转周期。地球自转是地球固有的性质，倒也不需要依赖太阳，找一个相对于宇宙遥远物质固定的方向看夹角变化就行了。通常选用春分点方向，并称春分点相邻两次经过地方经线之间的时间为一个恒星日。

严格来说由于岁差现象，春分点方向并不相对于宇宙遥远物质固定，因此恒星日与地球自转周期略有差异。不过两者的差异也不过几毫秒而已，可以忽略不计。故而通常默认恒星日就是地球自转周期。

平太阳日与恒星日随着时间推移都有所变化，不过通常默认它们（在短时间内）不变，因为变化程度很小。

### 平太阳日与恒星日的关系
不知诸位是否听说过「硬币悖论」——如果没有听过的话可以自行搜寻了解。1982 年 5 月 1 日的 SAT（全名就叫 SAT，不过有个俗称「美国高考」）就有一题不慎陷入了这个坑，毕竟出题人就没想那么多。

平太阳日与恒星日的差异恰恰就是硬币悖论造成的。

首先要提及的是，恒星日是将春分点方向当作固定方向得到的，故下面分析地球公转时同样用春分点视角。于是地球公转周期要当作回归年而非恒星年（宇宙遥远物质视角的周期，即实际周期）。

假设回归年是 $T$ 平太阳日。地球公转一周后，从平太阳的视角来看，共自转了 $T$ 周。由于硬币悖论，从春分点方向的视角来看，还会多自转一周而成为 $T+1$ 周。这样回归年便为 $T+1$ 恒星日。

用 $\text{d}\_\text{solar}$ 和 $\text{d}\_\text{sidereal}$ 分别表示平太阳日和恒星日，由上有 $T\kern{3 mu}\text{d}\_\text{solar}=(T+1)\kern{3 mu}\text{d}\_\text{sidereal}$。

平太阳日与恒星日之比便是 $\dfrac{\text{d}\_\text{solar}}{\text{d}\_\text{sidereal}}=\dfrac{T+1}{T}=1+\dfrac{1}{T}$。

回归年约为 365.2422 平太阳日，于是 $T\doteq365.2422$。计算得平太阳日与恒星日之比约为 1.002737909，该数值见于 IERS 约定。

### 用时间量纲计量角度
如果要用这类天文现象计量时间流逝的话就免不了测量角度。

上节讲到了「天」的原始含义。要贴近历史上的这个定义，时间 $1\kern{3 mu}\text{d}$ 就要对应角度 $360^\circ$。

由此，时角比（这个是我现编的伪术语，就当作是简便称呼）也就成为 $\dfrac{1\kern{3 mu}\text{d}}{360^\circ}=\dfrac{1}{15}\kern{3 mu}^\text{s}\kern{-3 mu}/\kern{-3 mu}\_\text{as}$。这个比例系数在后文相当常用。

### 太阳时与恒星时
先简要引入时角这一概念。从地方经线沿西往天体所在经线所计的夹角称作天体在地方的时角。

……但，为何以西为正呢？其实，从地方经线沿西往天体所在经线计夹角，同时就是从天体所在经线沿东往地方经线计夹角。把天体方向当作固定方向的话，由于地球自西向东公转，时角就会随时刻向后推移而越来越大了。

只是人毕竟是在地球某地观测天文现象的，所以用起点在观测点的说法就是以西为正。

太阳的时角乘上时角比就是天文太阳时，春分点的时角乘上时角比就是恒星时。太阳时也有视太阳时和平太阳时之分。

这样，天文太阳时的时刻零点是太阳正午，一个太阳日是 24 小时的太阳时，一个恒星日就是 24 小时的恒星时。

但是民用习惯的时刻零点是午夜，所以给天文太阳时加上 12 小时就得到了民用太阳时。

$t_\text{civil solar}=t_\text{astronomical solar}+12\kern{3 mu}\text{h}$

现在规范意义的术语「太阳时」是民用太阳时，但也确实存在用「太阳时」指代天文太阳时的情况，翻阅资料时务必留心。

设按平太阳时和恒星时所计的时间各为 $\Delta t_\text{solar}=k_\text{solar}\Delta t$ 和 $\Delta t_\text{sidereal}=k_\text{sidereal}\Delta t$。

$24\kern{3 mu}\text{h}=k_\text{solar}\kern{3 mu}\text{d}\_\text{solar}=k_\text{sidereal}\kern{3 mu}\text{d}\_\text{sidereal}$

因此 $\dfrac{\Delta t_\text{sidereal}}{\Delta t_\text{solar}}=\dfrac{k_\text{sidereal}}{k_\text{solar}}=\dfrac{\text{d}\_\text{solar}}{\text{d}\_\text{sidereal}}\doteq1.002737909$。

按恒星时与平太阳时计——而非反过来——的时间之比约为 1.002737909，也就是用恒星时的话会显得大一点。毕竟恒星日比平太阳日要短，与更短的时间比就会显得更长。

这个关系比较重要。因为平太阳终究不是现实的太阳，要得到平太阳时还是得从恒星时换算。

### GMT 的混乱历史
相信诸位或多或少会在时间相关的环境看到「GMT」这个词，它的全称是「Greenwich Mean Time」。

Greenwich 平均时间（英 Greenwich Mean Time, GMT）到底是什么呢？我也不知道——别笑，因为我确实不知道。

GMT 本身就是含义十分模糊的词语。从字面上看，GMT 是 Greenwich 经线的平均时，确切而言是平太阳时。但是现在所讲的 GMT 不能这样简单理解。

这个词语的含义为何会含混不清呢？自然是因为它有着混乱的历史。

说来也怪，GMT 的含义不但与历史时点有关，而且同时点不同机构也可能有所不同。

- 1805 年为止的英国皇家海军：使用 Greenwich 经线的时间，日期从正午算起，当天时刻从午夜算起。

19 世纪初尚且没有标准时的概念。各地使用当地的平太阳时，跨城市时就要重新校准时钟。在英国，由于蒸汽机车的发明与改进，铁路运输系统也就慢慢建立起来了。但这就出现了问题——短时间跨越长距离的话，校准时钟的频率可就相当高了，可能导致混乱，甚至发生事故。

1840 年 11 月，大西部铁路率先在时间表统一使用 GMT，「铁路时间」这一概念出现了。其它铁路局纷纷效仿。

- 民用意义下的 GMT：Greenwich 经线的平太阳时，日期和当天时刻均从午夜算起。

1847 年 9 月 22 日，铁路清算所下令，一旦邮政总局允许，所有车站均应采用 GMT。

1880 年 8 月 2 日，《时间定义法案》通过，GMT 获得法律地位而逐渐推广到全英国。

1884 年 10 月的国际经线会议上，Greenwich 经线成为 0° 经线，GMT 也就成为了通用时间。顺带一提，会议表决的世界日是从午夜算起的，符合民用习惯，也就是说起点比天文习惯的天文日早 12 小时。

……不过法国弃权了，而且相当长一段时间还坚持以 Paris 经线作为 0° 经线，甚至不肯叫 Greenwich 这个名字。

- 1925 年以前天文学意义下的 GMT：Greenwich 经线的平太阳时，日期和当天时刻均从正午算起。

- 1925 年以前英国天文年历的 GMT：Greenwich 经线的平太阳时，日期和当天时刻均从正午算起。

- 1925 年以来英国天文年历的 GMT：Greenwich 经线的平太阳时，日期和当天时刻均从午夜算起。

也就是说 00:00:00 从正午（现代意义的 12:00:00）突变为午夜（现代意义的 00:00:00）。天文意义就分出了「旧 GMT」和「新 GMT」。

1928 年 IAU 规定，将日期和当天时刻均从正午算起的 GMT 称为 Greenwich 平均天文时间（英 Greenwich Mean Astronomical Time, GMAT）。但是，人们似乎无视了这回事，于是 GMAT 也可能继续记为 GMT。乐死了.png

如此混乱的历史表明 GMT 这个词不能再用了，应该用新词来描述日期和当天时刻均从午夜算起的 GMT。

### UT
1884 年 10 月的国际经线会议中除了引入了「世界日」，还引入了「世界时」，但并没有作为专有名词。这个「世界时」仅仅只是避免在指称时出现地名而已。

1928 年 IAU 规定，将日期和当天时刻均从午夜算起的 GMT 称为世界时（英 Universal Time, UT、法 Temps universel, \[旧\] TU）；UT 又可称为 Greenwich 民用时间（英 Greenwich Civil Time, GCT）——但夏令时一实施的话，就会出现「Greenwich 民众使用的时间不是 GCT」的奇怪场景，所以这一条到 1935 年又废止了。德语可将 UT 称为 Weltzeit，缩写为 WZ。

1948 年 IAU 又重申了 UT 和 WZ 的用法。

1976 年 [IAU 第 16 届大会](https://www.iau.org/static/resolutions/IAU1976_French.pdf)上，第 4 和 31 委员会的第 1 号决议主张应将 GMT 按具体情形替换为 UT0、UT1、UT2 或 UTC，差异不重要时使用 UT；第 3 号决议主张缩写 TAI、TA、UT0、UT1、UT2、UTC、UT 用于任何语文，因此法文缩写 TU 不再使用。

至此，原始的民用 GMT 已经被 UT 这个词代替了，不应再使用。

### UT0
要测定世界时应该怎么做呢？时角（不考虑定向的话）是两条经线的夹角，因此计算世界时就要考虑经度。

世界时是 0° 经线的平太阳时。但是平太阳并不存在，所以只好直接测定恒星时角。

设世界时为 $\text{UT0}$，0° 经线恒星时为 $T_G$，地方恒星时为 $T_l$，观测站的经度为 $\lambda$，春分点的经度为 $\lambda_\text{VE}$，时角比为 $k$。此外，已知世界时为 $t_0$ 时 0° 经线恒星时为 $T_0$。

由于经度以东为正，从经度为 $A$ 的经线沿西往经度为 $B$ 的经线所计的夹角就是 $-(B-A)=A-B$。

$T_G=k(0-\lambda_\text{VE})$

$T_l=k(\lambda-\lambda_\text{VE})$

$\text{UT0}=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_G-T_0)$

联立解得 $\text{UT0}=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_l-k\lambda-T_0)$。

### UT1
考虑到极移现象，地球的自转轴并不相对于地球静止，所以地方经纬度也在不断变化。

计算 UT0 时用的经度是平均经度（可以认为是 ITRS 下的经度），没有考虑极移。如果要考虑极移，就得将南北方向置于真正的自转轴上，重新折算瞬时经度才行。

那就把 $z$ 轴建在自转轴上。回想起来，TIRS 便是如此。

$\text{\[TIRS\]}=W(t)\text{\[ITRS\]}=R_3(-s')R_2(x_p)R_1(y_p)\text{\[ITRS\]}$

当然，TIO 定位角并不需要考虑。一方面它本身非常小；另一方面我们的目的是把时刻统一起来，而它对经度差没有影响——大家都差那么多就相当于都没差。

因此考虑 $R_2(x_p)R_1(y_p)$ 就足够了。不妨用下标 $i$ 表示瞬时经纬度，无下标表示平均经纬度。寻找 $(\varphi_i,\lambda_i)$ 与 $(\varphi,\lambda)$ 的关系即可。

$\begin{aligned}\left\[\begin{matrix}\cos\varphi_i\cos\lambda_i\cr\cos\varphi_i\sin\lambda_i\cr\sin\varphi_i\end{matrix}\right\]&=R_2(x_p)R_1(y_p)\left\[\begin{matrix}\cos\varphi\cos\lambda\cr\cos\varphi\sin\lambda\cr\sin\varphi\end{matrix}\right\]\cr&=\left\[\begin{matrix}\cos x_p & 0 & -\sin x_p\cr0 & 1 & 0\cr\sin x_p & 0 & \cos x_p\end{matrix}\right\]\left\[\begin{matrix}1 & 0 & 0\cr0 & \cos y_p & \sin y_p\cr0 & -\sin y_p & \cos y_p\end{matrix}\right\]\left\[\begin{matrix}\cos\varphi\cos\lambda\cr\cos\varphi\sin\lambda\cr\sin\varphi\end{matrix}\right\]\cr&=\left\[\begin{matrix}\cos x_p\cos\varphi\cos\lambda+\sin x_p\sin y_p\cos\varphi\sin\lambda-\sin x_p\cos y_p\sin\varphi\cr\cos y_p\cos\varphi\sin\lambda+\sin y_p\sin\varphi\cr\sin x_p\cos\varphi\cos\lambda-\cos x_p\sin y_p\cos\varphi\sin\lambda+\cos x_p\cos y_p\sin\varphi\end{matrix}\right\]\end{aligned}$

……大抵不会有别的人像我这样蠢到手算了。

于是 $\lambda_i=\operatorname{atan2}(\cos y_p\cos\varphi\sin\lambda+\sin y_p\sin\varphi,\cos x_p\cos\varphi\cos\lambda+\sin x_p\sin y_p\cos\varphi\sin\lambda-\sin x_p\cos y_p\sin\varphi)$。

令 $\Delta\lambda=\lambda_i-\lambda$，则得到经度修正量。应该怎么用呢？

设测到的地方时为 $T$，实际上的世界时为 $\text{UT1}$。最初计算世界时的时候以为观测站的经度就是 $\lambda$，因此算出来的世界时 $\text{UT0}=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_l-k\lambda-T_0)$。

观测站的实际经度应该是 $\lambda_i=\lambda+\Delta\lambda$。

代入得 $\begin{aligned}\text{UT1}&=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_l-k\lambda_i-T_0)\cr&=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_l-k(\lambda+\Delta\lambda)-T_0)\cr&=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_l-k\lambda-T_0)-k\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}\Delta\lambda\cr&=\text{UT0}-k\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}\Delta\lambda\end{aligned}$。

$\text{UT1}=\text{UT0}-k\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}\Delta\lambda$

另外 $\Delta\lambda$ 的表达式过于复杂，也应该尽可能在保证精度的同时简化。

注意到 $\displaystyle\lim_{(x_p,y_p)\rightarrow(0,0)}\Delta\lambda=0$（至少在 $\lambda\ne\pi$ 时如此），于是 $(x_p,y_p)$ 充分接近 $(0,0)$ 时将有 $\Delta\lambda=\arctan\tan(\lambda_i-\lambda)$。

令 $(\alpha,\beta)=(\cos y_p\cos\varphi\sin\lambda+\sin y_p\sin\varphi,\cos x_p\cos\varphi\cos\lambda+\sin x_p\sin y_p\cos\varphi\sin\lambda-\sin x_p\cos y_p\sin\varphi)$，则 $\tan\lambda_i=\dfrac{\alpha}{\beta}$。

$\Delta\lambda=\arctan\tan(\lambda_i-\lambda)=\arctan\dfrac{\tan\lambda_i-\tan\lambda}{1+\tan\lambda_i\tan\lambda}=\arctan\dfrac{\alpha-\beta\tan\lambda}{\beta+\alpha\tan\lambda}$

将 $\alpha$ 与 $\beta$ 按 $x_p$ 与 $y_p$ 展开成 Taylor 多项式，阶数够用就行。

$\alpha=\cos\varphi\sin\lambda+y_p\sin\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)$

$\beta=\cos\varphi\cos\lambda-x_p\sin\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)$

「所以你就只展开到一阶？」

嘛人一懒就是这样的。

$\dfrac{\alpha-\beta\tan\lambda}{\beta+\alpha\tan\lambda}=\dfrac{(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)}{1-(x_p\cos\lambda-y_p\sin\lambda)\tan\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)}=(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)$

……这一部分仍然是手算的，应该没有算错。

$\Delta\lambda=\arctan\dfrac{\alpha-\beta\tan\lambda}{\beta+\alpha\tan\lambda}=(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)$

这样 $(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi$ 便成为 $\Delta\lambda$ 关于变元 $(x_p,y_p)$ 在 $(0,0)$ 附近的一阶近似，于是可以直接把它当作 $\Delta\lambda$。

$\Delta\lambda=(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi$

$\text{UT1}=\text{UT0}-\dfrac{1}{15\times1.002737909}\kern{3 mu}^\text{s}\kern{-3 mu}/\kern{-3 mu}\_\text{as}\kern{3 mu}(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi$

最终得到了 UT0 的极移修正版本，也就是 UT1。通常所说的 UT 便是指 UT1。

不过 $\|\Delta\lambda\|$ 本身很小，所以实际计算时通常就取 $\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}=1$，公式也就近似为 $\text{UT1}=\text{UT0}-\dfrac{1}{15}\kern{3 mu}^\text{s}\kern{-3 mu}/\kern{-3 mu}\_\text{as}\kern{3 mu}(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi$。当然，本文这一步就不近似了。

值得注意的是，[Bulletin horaire 系列 4](https://bibnum.obspm.fr/ark:/11287/3wsDZ) 第 4 号给出的公式（见 79 页，另可见[重排版](https://www.ucolick.org/~sla/leapsecs/BHs4n4.pdf)）和上面写的并不一样。

$\Delta\lambda=\lambda_i-\lambda_m=\dfrac{1}{15}(x\sin\lambda_m-y\cos\lambda_m)\operatorname{tg}\varphi_m$

$\text{TU1}=\text{TU0}+\Delta\lambda$

因为当时国际时间局（法 Bureau international de l'heure, BIH、英 International Time Bureau）的约定是西经为正，所以当中出现的 $\lambda$ 其实相当于现在的 $-\lambda$。这个 $\Delta\lambda$（忽略量纲差异的话）也就成了之前所述 $\Delta\lambda$ 的相反数。

将 $\lambda$ 全部换成 $-\lambda$ 试试。

$\Delta(-\lambda)=-\lambda_i-(-\lambda_m)=\dfrac{1}{15}(x\sin(-\lambda_m)-y\cos(-\lambda_m))\operatorname{tg}\varphi_m$

$\text{TU1}=\text{TU0}+\Delta(-\lambda)$

然后化简。

$\Delta\lambda=\lambda_i-\lambda_m=\dfrac{1}{15}(x\sin\lambda_m+y\cos\lambda_m)\operatorname{tg}\varphi_m$

$\text{TU1}=\text{TU0}-\Delta\lambda$

忽略量纲差异的话，可以看出并没有区别。

然而这个 UT1 的算法已经过时了，现在已经不再通过天文观测确定时间，UT0 也就不再使用。现代计算 UT1 借助 ERA（就是之前提到过的地球自转角）完成。

考虑到当今 UT1 才是可以直接得到的参数，书写公式时通常写成 UT0 减去 UT1 的形式。

$\text{UT0}-\text{UT1}=\dfrac{1}{15\times1.002737909}\kern{3 mu}^\text{s}\kern{-3 mu}/\kern{-3 mu}\_\text{as}\kern{3 mu}(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi$（其中 CIP 坐标 $x_p$ 与 $y_p$ 之正向依照 IERS 约定，分别指向 0° 与 90°W 经线）

### UT2
地球自转的状况其实也和季节有关。

姑且说一种比较扯而又不是没可能的原因。冬天积雪、夏天融雪会使地球的转动惯量改变，从而影响自转。当然，听起来有点「同性恋清淡饮食可以成为异性恋」的味道，不过并不是那么不靠谱。大气压、地下水应该也算可能的原因。

UT2 便是在 UT1 的基础上用经验公式加偏移来处理这个问题。公式的系数倒是变过几次。

先放一下 [Bulletin horaire 系列 4](https://bibnum.obspm.fr/ark:/11287/3wsDZ) 第 4 号中规定的 1956 年用公式（见 81 页，另可见[重排版](https://www.ucolick.org/~sla/leapsecs/BHs4n4.pdf)）。

$\Delta T_s=+0^\text{s},022\sin2\pi t-0^\text{s},017\cos2\pi t-0^\text{s},007\sin4\pi t+0^\text{s},006\cos4\pi t$

下标大抵是指 saisonnière（季节的）。倒也没讲清楚 $t$ 指什么。

UT0、UT1 与 UT2 三者间的关系用连等式 $\text{TU2}=\text{TU0}+\Delta\lambda+\Delta T_s=\text{TU1}+\Delta T_s$ 表示。

最终确定的公式是下面这个。

$\text{UT2}-\text{UT1}=(0.022\sin2\pi T-0.012\cos2\pi T-0.006\sin4\pi T+0.007\cos4\pi T)\kern{3 mu}\text{s}$

而且明确指出了 $T$ 为 Bessel 年。

IERS 公告的补充说明曾（[1992 年 12 月](https://web.archive.org/web/19980426111938/http://gibs.leipzig.ifag.de/MISC/IERS/bulletinb.guide.old)、[1994 年 3 月](https://web.archive.org/web/19980426111938/http://gibs.leipzig.ifag.de/MISC/IERS/bulletinb.guide.old)、[1995 年 3 月](https://web.archive.org/web/19980426095006/http://gibs.leipzig.ifag.de/MISC/IERS/bulletinb.guide)、[2000 年 3 月](https://hpiers.obspm.fr/iers/bul/bulb/BULLETINB.html)）指定的 Bessel 年算法为 $T=2000.000+\dfrac{\text{MJD}-51544.03}{365.2422}$。

到 [2004 年 8 月](https://hpiers.obspm.fr/iers/bul/bulb/explanatory.pdf)又删了。可能是觉得之前给的算法系数精度有些低，或者是发现计算机的算力在迅速发展。这么一想原点偏移到 2000 年大抵是为了减小 2000 年前后的误差。不过……[IERS RS/PC 某网页](https://maia.usno.navy.mil/information/eo-values)还留着呢。

MJD 用哪个时间尺度算才对呢？其实给出这个公式的时候好像没太有区分 JD 的时间尺度的概念，至少[《2001 年用天文年历》](https://archive.org/details/astronomicalalma0000unse_i5l9)（见 B4 页）中确实没有。

$\text{Julian epoch}=\text{J}\left\[2000.0+\dfrac{\text{JD}-2451545.0}{365.25}\right\]$

$\text{Besselian epoch}=\text{B}\left\[1900.0+\dfrac{\text{JD}-2415020.31352}{365.242198781}\right\]$

到现在便重视时间尺度的差异了，[《2017 年用天文年历》](https://archive.org/details/astronomicalalma0000unse_s2r1)（见 B3 页）就用下标明确指出按地球时算。

$\text{Julian epoch}=\text{J}\left\[2000.0+\dfrac{\text{JD}\_\text{TT}-2451545.0}{365.25}\right\]$

$\text{Besselian epoch}=\text{B}\left\[1900.0+\dfrac{\text{JD}\_\text{TT}-2415020.31352}{365.242198781}\right\]$

规定用地球时也不是没有原因。因为过去计算纪元时用的是历书时，而地球时设计上正是为了取代历书时。

$\text{UT2}-\text{UT1}=(0.022\sin2\pi T-0.012\cos2\pi T-0.006\sin4\pi T+0.007\cos4\pi T)\kern{3 mu}\text{s}$（其中 $T=1900.0+\dfrac{\text{JD}\_\text{TT}-2415020.31352}{365.242198781}$）

现在很少使用 UT2 了，不过 IERS 公告 A 至今还在开头提供 UT2 的公式。

## 原子时
### 原子钟
高中物理中讲到，核外电子跃迁有光子的频率条件，而且这个频率条件相当稳定。如果以跃迁状态作为反馈讯号调节计时器，使计时器的频率与跃迁频率保持一致，计时器就能准确走时而不乱跑了。这就是原子钟的原理。

~~我没用过原子钟，更没制造过原子钟，以上说法是我凭空脑补的。~~

原子核自旋、电子自旋等对称破缺因素会导致能级分裂。特别是，碱金属原子可以分裂出间隔很小的超精细能级，跃迁频率在微波级别。毕竟频率堪比可见光的震荡源还不是太成熟的东西，不过光钟也在试验就是了。

### 不统一的原子时标准
1948 年，美国国家标准局研制出世界上第一台氨原子钟……等等，氨？它确实没用当今常见的铯原子，而是用了氨分子。然而这玩意走时比石英钟还不准，拿来计时就相当不可靠了。

1955 年，英国国家物理实验室研制出世界上第一台铯原子钟。铯原子钟就相当可靠，可谓好铯。虽然当时仅仅是偶尔找机会用单个原子钟校准石英钟，而不是让原子钟持续跑下去。由此得到了 Greenwich 原子时（英 Greenwich Atomic, GA）。

1956 年 9 月 13 日，美国海军天文台根据美国海军研究实验室的铯原子钟得到了原子时标准，称作 A.1。1959 年，A.1 的历元被重置到 UT2 的 1958 年 1 月 1 日 00:00:00。当然当时各个机关用的 UT2 都不见得相同，至少这里是指美国海军天文台自身维护的 UT2。

1957 年 10 月 9 日，美国国家标准局也有了自己的原子时标准 NBS-A，而且历元也在 1959 年重置到了 UT2 的 1958 年 1 月 1 日 00:00:00。

有着如此多各有差异的原子时标准，要比较记录就显得相当麻烦。各原子时标准的历元从 1959 年开始重置，一直到 1960 年才全部重置完毕。

### 秒的现代定义
现在的物理界中，单位的物理含义总与 SI 定义挂钩。哪怕用 Gauss 单位制这样的非 SI 单位制也好，仍要转换成 SI 然后依 SI 定义解释物理含义。时间单位的解释也不例外。

既然提到了 SI，就不得不提定义并贯彻实施 SI 的国际计量组织。依《米制公约》，国际计量组织共设立三个机构。
- 国际计量局（法 Bureau international des poids et mesures, BIPM、英 International Bureau of Weights and Measures）
- 国际计量委员会（法 Comité international des poids et mesures, CIPM、英 International Committee for Weights and Measures）
- 国际计量大会（法 Conférence générale des poids et mesures, CGPM、英 General Conference on Weights and Measures）

三者的职责分配则依《米制公约》第三条所定——BIPM 在 CIPM 的指导和监督下运作，而 CIPM 本身则受由各缔约国政府代表所组成的 CGPM 管辖。

CIPM 下设 10 个咨询委员会。
- 声学、超声和振动咨询委员会（法 Comité consultatif de l'acoustique, des ultrasons et des vibrations, CCAUV、英 Consultative Committee for Acoustics, Ultrasound and Vibration），1998 年设立。
- 电磁咨询委员会（法 Comité consultatif d'électricité et magnétisme, CCEM、英 Consultative Committee for Electricity and Magnetism），1927 年设立。<br>原名电学咨询委员会（法 Comité consultatif d'électricité, CCE、英 Consultative Committee for Electricity），1997 年改为现名。
- 长度咨询委员会（法 Comité consultatif des longueurs, CCL、英 Consultative Committee for Length），1952 年设立。<br>原名米定义咨询委员会（法 Comité consultatif pour la définition du mètre, CCDM、英 Consultative Committee for the Definition of the Metre），1997 年改为现名。
- 质量和相关量咨询委员会（法 Comité consultatif pour la masse et les grandeurs apparentées, CCM、英 Consultative Committee for Mass and Related Quantities），1980 年设立。
- 光度和辐射度咨询委员会（法 Comité consultatif de photométrie et radiométrie, CCPR、英 Consultative Committee for Photometry and Radiometry），1933 年设立。<br>原名光度咨询委员会（法 Comité consultatif de photométrie, CCP、英 Consultative Committee for Photometry），1971 年改为现名。
- 物质的量（化学和生物计量）咨询委员会（法 Comité consultatif pour la quantité de matière : métrologie en chimie et biologie, CCQM、英 Consultative Committee for Amount of Substance: Metrology in Chemistry and Biology），1993 年设立。
- 电离辐射咨询委员会（法 Comité consultatif des rayonnements ionisants, CCRI、英 Consultative Committee for Ionizing Radiation），1958 年设立。<br>原名电离辐射测量标准咨询委员会（法 Comité consultatif pour les étalons de mesure des rayonnements ionisants, CCEMRI、英 Consultative Committee for Measurement Standards of Ionizing Radiation），1997 年改为现名。
- 温度咨询委员会（法 Comité consultatif de thermométrie, CCT、英 Consultative Committee for Thermometry），1937 年设立。
- 时间频率咨询委员会（法 Comité consultatif du temps et des fréquences, CCTF、英 Consultative Committee for Time and Frequency），1956 年设立。<br>原名秒定义咨询委员会（法 Comité consultatif pour la définition de la seconde, CCDS、英 Consultative Committee for the Definition of the Second），1997 年改为现名。
- 单位制咨询委员会（法 Comité consultatif des unités, CCU、英 Consultative Committee for Units），1964 年设立。

1967 年 10 月，CGPM 第 13 届会议[第 1 号决议](https://www.bipm.org/fr/committees/cg/cgpm/13-1967/resolution-1)修改了 SI 中秒的定义。自此，SI 中秒便是以铯-133 原子基态超精细能级跃迁频率 $\Delta\nu_\text{Cs}$ 定义的，也就是秒的现代定义。

[SI 手册第九版](https://www.bipm.org/fr/publications/si-brochure)写道：符号为 $\text{s}$ 的秒是时间的 SI 单位。它是以将铯频率 $\Delta\nu_\text{Cs}$（铯-133 原子不受扰动的基态超精细能级跃迁频率）取作定值（用等同于 $\text{s}^{-1}$ 的单位 $\text{Hz}$ 表示时，数值为 9192631770）的手法定义的。

这一定义语句表明 $\Delta\nu_\text{Cs}=9192631770\kern{3 mu}\text{Hz}$。因此 $1\kern{3 mu}\text{Hz}=\dfrac{\Delta\nu_\text{Cs}}{9192631770}$，两边同时除 1 就得到了秒的定义式。

$1\kern{3 mu}\text{s}=\dfrac{9192631770}{\Delta\nu_\text{Cs}}$

这个定义究竟是怎么来的呢？

SI 秒启用原子跃迁频率定义之前是以历书时定义的，称为历书秒。该定义由 IAU 提出。

1958 年，英国国家物理实验室与美国海军天文台的联合实验[结果](http://www.leapsecond.com/history/1958-PhysRev-v1-n3-Markowitz-Hall-Essen-Parry.pdf)表明，一个历书秒相当于铯-133 基态超精细能级跃迁的 9192631770 个周期（误差范围是 ±20 周期）。这就为 SI 秒的新定义打下了实验基础。

1967 年 8 月 [IAU 第 13 届大会](https://www.iau.org/static/resolutions/IAU1967_French.pdf)上，第 4 和 31 委员会的第 5 号决议指出，CGPM 应当在表明「历书秒不是 SI 的一部分」的段落中注明「历书秒为 IAU 天文常数系统的一部分」——这是 IAU 的要求。

结果 1967 年 10 月 [CGPM 第 13 届会议](https://www.bipm.org/fr/committees/cg/cgpm/13-1967)上并没有同意这个要求——决议里压根没提到「历书秒」这个词，而是说「目前生效的定义」。BIPM 局长 Jean Terrien [后来指出](https://iopscience.iop.org/article/10.1088/0026-1394/8/3/004)（见 103 页左下方至右上方）BIPM 并没有做时间和频率测量的实验工作（因此他本人也加入了 IAU 第 31 委员会），并且认为这方面天文学家和物理学家之间有着误解。

1976 年 [IAU 第 16 届大会](https://www.iau.org/static/resolutions/IAU1976_French.pdf)上，第 4 委员会的第 1 号建议中提出了 1976 年版的 IAU 天文常数系统，注释中提到时间以 SI 秒为基础，在误差范围内与原历书秒一致。于是 IAU 天文常数系统也不再采用历书秒。

### 国际原子时
20 世纪 60 年代，BIH 就在监测无线电广播的手段参考各机构的原子时标准，加权平均后得到 BIH 的原子时标准。起初只选了三种最佳标准作参考，因而称为 A3；后来纳入越来越多的标准，不断调整权重，之后改称 TA(BIH)。

TA(BIH) 仍不算正式的国际标准。

1970 年 6 月，[CCDS 第 5 届会议](https://www.bipm.org/fr/committees/cc/cctf/5-1970)提出了国际原子时（法 Temps atomique international, TAI、英 International Atomic Time）的定义：TAI 是 BIH 根据各机构运行的原子钟读数（以 SI 的时间单位秒为基础）综合确定的时间参考坐标。

TAI 的定义中明确了统一的秒长，即 SI 秒。

1971 年 10 月 CGPM 第 14 届会议[第 1 号决议](https://www.bipm.org/fr/committees/cg/cgpm/14-1971/resolution-1)指出，CGPM 批准 CIPM 定义 TAI，定义与 BIH 合作实施。

由于引力时间膨胀，不同高度的机构给出的数据偏差越来越大。而计算 TAI 时没有考虑引力时间膨胀，仅是按各机构的数据计算加权平均值，秒长愈发不明确。

1976 年 [IAU 第 16 届大会](https://www.iau.org/static/resolutions/IAU1976_French.pdf)上，第 4 和 31 委员会的第 2 号决议中提出 TAI 的秒长在 1977 年 1 月 1 日 00:00:00 时应调整至与海平面处的 SI 秒同步。

之后，直接算出来的加权平均值就称为自由原子时（法 Échelle atomique libre, EAL）。目前计算 EAL 所需原始数据的来源机构可在 [BIPM 某网页](https://webtai.bipm.org/database/showlab.html)看到。

取高精度原子钟（例如铯原子喷泉钟）测定数据，考虑引力时间膨胀、黑体辐射频移等因素，将秒长校准到大地水准面处的 SI 秒，便可得到主频率标准（英 Primary frequency standard, PFS）和副频率标准（英 Secondary frequency standard, SFS）。

以 PFS、SFS 与 EAL 的秒长比例为依据修正 EAL 便得到了 TAI。

可以说得到 TAI 的过程中，EAL 借着设备广泛分布求稳，PFS 与 SFS 借着高精度求准，结果也就既稳定又准确。

## 协调世界时
### 无线电广播时间信号与协调 UT 广播
诸位能想到哪些对时方式呢？电视台有整半点报时，透过网路可以用 NTP，导航卫星也能授时。不过 20 世纪常用无线电广播时间信号，早在 20 世纪 30 年代便有广泛应用，而且至今还用着呢。所谓电波表就是应用之一。基本原理就是把时间信号封装到脉冲里播送出去。

无线电广播这块主要由国际电信联盟无线电通信部门（英 International Telecommunication Union Radiocommunication Sector, ITU-R）管理，其前身是国际无线电咨询委员会（法 Comité consultatif international pour la radio, CCIR、英 International Radio Consultative Committee）。

1948 年 [CCIR 第 5 届全会](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.271.43.en.101.pdf)上，第 18 号建议（见 65 页）呼吁研究全球标准频率与时间服务。

1951 年 [CCIR 第 6 届全会](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.272.43.en.100.pdf)上，第 70 号建议（见 76 页）规定发射频率误差在 $\pm2\times10^{-8}$ 以内，要求当局定期向 CCIR 报告。

1953 年 [CCIR 第 7 届全会](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.273.43.en.100.pdf)上，第 122 号建议（见 150 页）取代第 70 号建议，要求以一个平太阳秒为脉冲间隔，尽可能与 UT 同步，发射频率误差在 $\pm2\times10^{-8}$ 以内，CCIR 应继续与 BIH 和 URSI 合作。

1955 年 9 月 IAU 第 9 届大会上，第 31 委员会规定自 1956 年 1 月 1 日起，无线电广播时间信号应提供 UT2。可在 [Bulletin horaire 系列 4](https://bibnum.obspm.fr/ark:/11287/3wsDZ) 第 4 号找到相关内容摘录（见 77 页，另可见[重排版](https://www.ucolick.org/~sla/leapsecs/BHs4n4.pdf)）。

1956 年 [CCIR 第 8 届全会](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.274.43.en.100.pdf)上，第 179 号建议（见 185 页）取代第 122 号建议，要求脉冲以一秒为间隔并保持在 UT2 的 50 毫秒以内，发射频率误差在 $\pm2\times10^{-8}$ 以内，CCIR 应继续与 BIH 和 URSI 合作。

1958 年 8 月 IAU 第 10 届大会上，Louis Essen 报告称英国将采用铯原子时广播时间信号。

1959 年 [CCIR 第 9 届全会](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.275.43.en.1001.pdf)上，第 319 号建议（见 317 页）取代第 179 号建议，要求脉冲以一秒为间隔并保持在 UT2 的 50 毫秒以内，发射频率大致对应 UT2、与历书时之差尽可能恒定、一年内保持恒定且误差在 $\pm5\times10^{-9}$ 以内，CCIR 应继续与 BIH 和 URSI 合作。

1959 年 8 月，英美两国机构同意从 1960 年开始依 IAU 与 CCIR 框架协调时间与频率传输。

1960 年，英美两国开始试验协调 UT 广播。美国的 UT2 无线电广播时间信号用来调整铯频率偏移。

1961 年 8 月 IAU 第 11 届大会上，第 31 委员会会议提到了英美两国的协调试验。委员会 31 决定，BIH 应确定每年度协调广播所用的铯频率偏移。于是，1961 年至 1971 年的协调 UT 广播就由 BIH 负责确定频率偏移（秒长）和步长（跳秒）。

1963 年 [CCIR 第 11 届全会](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.276.43.en.1003.pdf)上，第 374 号建议（见 193 页）取代第 319 号建议，要求频率一年内保持恒定但要依 UT2 秒长偏移，基准频率是铯频率 $f(\text{Cs})=9192631770\kern{3 mu}^\text{c}\kern{-3 mu}/\kern{-3 mu}\_\text{s}$（$\text{c}\kern{-3 mu}/\kern{-3 mu}\_\text{s}$ 指 cycles per second，即「周期每秒」，今作赫兹 $\text{Hz}$），脉冲以一秒为间隔并保持在 UT2 的约 100 毫秒以内，脉冲相位变化应为 50 ms 并由相关电台同时调整。这个做法自然参考自英美协调试验。

1964 年 8 月 [IAU 第 12 届大会](https://www.iau.org/static/resolutions/IAU1964_French.pdf)上，第 31 委员会的决议便提到了无线电广播 UT2 的方案。实际发射频率 $F$ 与标称频率 $F_0$ 及相对偏移 $s$ 的关系是 $F=F_0(1+s)$，基准频率是铯频率 $\nu=9192631770\kern{3 mu}\text{Hz}$。相对偏移 $s$ 的可能取值是 $50n\times10^{-10}$，其中 $n$ 是正或负整数。

1965 年 [Bulletin horaire 系列 J](https://bibnum.obspm.fr/ark:/11287/27dZS) 第 1 号一句黑体写着的定义（见 2 页）中出现了法文 TUC 及英文 UTC 字样，是已知最早使用 UTC 一词的出版物。UTC 其实并不符合英语语序，或许是为了与 UT0、UT1、UT2 的格式保持一致。

总之从 1964 年起这种能在国际高精度同步广播的 UT 就被自发称为 UTC 了，但还没有成为正式称呼，尤其是 CCIR 坚持提及 UT2 而不使用 UTC 一词。

1965 年，BIH 开始用自己的原子时标准计算 UTC。

美国海军天文台的出版物倒既没称作 UT2，也没称作 UTC，而是称作 UT2C。

除了这种调整秒长的做法，当时还有不调整秒长的做法。

20 世纪 60 年代，美国和德国的长波无线电广播时间信号使用步进原子时（英 Stepped Atomic Time, SAT、法 Temps atomique à sauts, TAS）。秒长采用原子秒长，依时机插入 100 毫秒或 200 毫秒的步长以与 UT2 同步。这就是说，SAT 只跳秒，而不改变秒长。

1966 年 [CCIR 第 11 届全会](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.277.43.en.1003.pdf)上，第 374-1 号建议（见 281 页）参考了这种做法，并且规定了具体细节。例如，铯频率 $f(\text{Cs})=9192631770\kern{3 mu}\text{Hz}$ 取作时间间隔测量标准；与 UT2 的差异应控制在约 100 毫秒以内；载波频率与时间信号速率均不偏移时，调整时机为每月第一日，调整量为 100 毫秒的整数倍。

可惜获得各电台的完整调整记录并非易事，于是用 SAT 记录的时刻很难知道精确的时点。不过 SAT 的实现方式可以视作闰秒的雏形，这就是它的历史意义。

1969 年，CCIR 第 7/1 临时工作组 编制了 CCIR 全会第 VII/1008 号档案。根据[相关记录](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.278.43.en.1010.pdf)，该档案是 CCIR 第 460 号建议的草案（见 260 页），正式采用时删去了第二节的「或其整数倍」（见 116 页）。

1970 年 2 月 3 日，[CCIR 第 12 届全会第 13 次会议](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.278.43.en.1004.pdf)上，代表不顾各科学协会的意见，单方面宣布 1972 年 1 月 1 日开始采用新的闰秒方案，也就是 CCIR 第 460 号建议（见 227 页）。当中规定，1972 年 1 月 1 日起，载波频率和时间信号都不应有所偏移，保持恒定并与 SI 秒的定义一致；必要时应以 1 秒为步长调整标度，以与 UT（原文没明讲是 UT1 还是 UT2）近似一致。从修改记录可以看出，草案允许任意整数秒步长，正式案改为 1 秒步长，这就形成了现代的闰秒机制。

这种形式在之前从来没有广播试行过，遑论正式使用。可以说这种 1 秒步长的方案是 CCIR 大胆的独创。不过，文本中仍然没有出现 UTC 一词。

1970 年 8 月 [IAU 第 14 届大会](https://www.iau.org/static/resolutions/IAU1970_French.pdf)上，第 4 委员会、第 31 委员会及两委员会的联席会议上讨论了 CCIR 这种将闰秒施于无线电广播时间信号的做法。IAU 成员讨论无线电广播时间尺度的时候用了 UTC 一词。第 31 委员会会议上有人指出 CCIR 未通知 IAU，因此 IAU 无法在本届大会回应；下一届大会在 1973 年举行，此时 CCIR 第 460 号建议已经生效。

会上，第 4 委员会的第 6 号决议指出，协调世界时（UTC）与世界时（UT1）的差异应不超过 0.1 秒。第 31 委员会提出了实施闰秒的方案，时点 1 月 1 日与 7 月 1 日便是在此出现的。

1971 年 2 月，CCIR 第 7 研究组开会制定了实施 CCIR 第 460 号建议的详细说明，即 [CCIR 第 517 号报告](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.278.43.en.1004.pdf)（见 258 页）。这时，他们真的采用 UTC 这个词了！
- 要求 BIH 在 1971 年底重置信号，使 UTC 的 1972 年 1 月 1 日 00:00:00 与 BIH 原子时的 1972 年 1 月 1 日 00:00:10 一致
- UTC 与 UT1 的差异应小于 0.7 秒，该条注释中提到「GMT 可作为 UT1 的等价概念」
- 提出「正闰秒」（插入的秒）与「负闰秒」（跳过的秒）两个概念
- 规定闰秒应产生在 UTC 的月底，建议时点是 12 月 31 日及 6 月 30 日，提出了正闰秒所用的记号 23:59:60
- 要求 BIH 提前 8 周宣布闰秒
- 将 UT1-UTC 的估计值称为 DUT1
- 要求 BIH 提前一个月公布 DUT1 的值

1972 年 1 月 1 日，CCIR 第 460 号建议生效。从此，无线电广播时间信号的秒长总是 SI 秒长，一天的长度却不一定是 86400 秒。这时，使用闰秒的 UTC——尽管，仍没有正式名称——出现了。

1973 年 [IAU 第 15 届大会](https://www.iau.org/static/resolutions/IAU1973_French.pdf)上，第 4 和 31 委员会的决议 1 指出，UTC 系统直接提供导航与测量所需精度的平太阳时。决议 4 给出了更多闰秒相关的建议：UT1-UTC 的容许范围设为 ±0.950 秒；UT1 与 UTC+DUT1 的偏差范围设为 ±0.100 秒；允许在任何月的月底引入闰秒，但首先考虑 6 月底和 12 月底，其次考虑 3 月底和 9 月底。

### UTC 的转正历程
1974 年 7 月，[CCIR 第 13 届全会](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.279.43.en.1007.pdf)（或可参考[法文版](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.279.43.fr.2007.pdf)）提出了 CCIR 第 460-1 号建议（见 18 页）。这时，协调世界时（英 Coordinated Universal Time, UTC、法 Temps universel coordonné, \[旧\] TUC）一语终于正式使用。UTC 与 UT1 的偏差范围设为 ±0.9 秒（倒不是 IAU 建议的 ±0.95 秒），UTC+DUT1 与 UT1 的偏差范围设为 ±0.1 秒。

1975 年 CGPM 第 15 届会议[第 5 号决议](https://www.bipm.org/fr/committees/cg/cgpm/15-1975/resolution-5)认可了 UTC 近似作为 UT（甚至平太阳时）的做法，而且认定 UTC 提供了民用时基础。

如上章所言，IAU 在 1976 年就约定缩写 UTC 用于任何语文。但 CCIR 并没有立刻修改。

1978 年 6 月 15 日 [CCIR 第 14 届全会](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.280.43.en.1007.pdf)上，第 7 研究组作了相关报告（见 XI 页）。UTC 部分第一句便说了「1972 年 UTC 由第 460 号建议引入」，既没有认为 1972 年以前的协调 UT 是 UTC，也没有提到 1974 年才正式使用 UTC 一词。第 7/1 号临时工作组负责实施 UTC，第 7 研究组认为这项工作已经完成，于是在修改完 DUT1 编码传输方案之后，第 7/1 号临时工作组也该解散了——其实，到 1984 年的话 POSIX 项目也就开始了，偏偏解散了最适合回答相关问题的工作组，以至于留下了 POSIX 时间戳这个烂摊子……

第 535 号建议（见 12 页）指出国际电信活动应使用 UTC 代替 GMT 一词。

第 536 号建议（见 13 页）指出缩写 TAI、TA、UT、UTC、DUT1 用于任何语文。UTC 列入 UT 的形式下，也就是说认定 UTC 属于 UT。当然有趣的一点是，TAI 的来源标记为 1971 年 10 月的 CGPM 第 14 届会议，UTC 的来源标记为 1975 年 5 月的 CGPM 第 15 届会议，也就是说 CCIR 声称两个缩写的来源是 CGPM。

1982 年 [CCIR 第 15 届全会](https://search.itu.int/history/HistoryDigitalCollectionDocLibrary/4.281.43.en.1008.pdf)上，第 7 研究组主席的讲话（见 XVII 页）不可不谓是精彩的合订本。开幕说道「1982 年是协调世界时（UTC）系统的十周年，该系统在 1972 年 1 月 1 日基本以现在的形式引入」——为何要强调「现在的形式」？后面就说「1972 年以前，UTC 系统采用不同的形式，传输的时间信号时间步长和速率有所调整」——可你 1978 年不是说 UTC 是 1972 年引入的吗？

不管如何，UTC 转正了，真是可喜可贺。

### JD 类表示法
在 UTC 上使用 JD 类表示法存在问题，因为在 UTC 中一天并不一定是 86400 秒。

若直接以常规的时进位法理解 UTC 的形式标度（例如，23:59:60 视作与次日的 00:00:00 相同）而得到 JD 类表示，既存在某个 JD 类表示不对应任何时刻的情形（负闰秒），也存在不同时刻对应相同的 JD 类表示的情形（正闰秒）。本文称作 literal-JD。这样计算的 JD 类表示在本文用下标 UTC literal 标记。

若令每天 00:00:00 对应 JD 的小数部分为 0.5，一天的长度视作变动的（负闰秒的情形小于 86400 秒，正闰秒的情形大于 86400 秒），按 UTC 日期分段确定一次函数的表达式的话，得到的 JD 类表示便是关于时刻的双射。

就特征而言以 JD+0.5 表示更为妥当。

floor(JD+0.5) 在且仅在 UTC 日期改变时改变，幅度为 1；时刻到 floor(JD+0.5) 的函数不减且右连续；1960 年 1 月 1 日 00:00:00 的 JD+0.5 为 2436935。

令当前 UTC 日期的 00:00:00 为 0，当前 UTC 日期的日末（无闰秒、正闰秒、负闰秒的情形各等于、大于、小于 24:00:00）为 1 作关于 UTC 标度的一次函数，则该函数即给出 $\[0,1)$ 范围内的实数 JD+0.5-floor(JD+0.5)。

最终 JD+0.5 应当是关于时刻的递增连续双射。注意约束条件出现的是 JD+0.5 而非 JD，因此会出现 12:00:00 对应 JD 不是整数的情形。

……我想这约束条件够详细了，应当能唯一确定结果。这是 [SOFA](https://www.iausofa.org/) 及其衍生库 [ERFA](https://github.com/liberfa/erfa) 使用的约定，称作 quasi-JD。这样计算的 JD 类表示在本文用下标 UTC quasi 标记。

### UTC 的实现细节
UTC 标度在 1972 年以前及以来均关于时刻右连续，因此出现跃度（闰秒）时，间断点只可能贴近后续时刻。

#### 1960 年至 1971 年的 UTC
1960 年至 1971 年，UTC 既有频率偏移，也有步长调整，同步对象是 UT2。

IERS EOC 至今提供 1961 年以来 UTC 相对频率偏移及步长调整的[数据](https://hpiers.obspm.fr/iers/bul/bulc/TimeSteps.history)。当然，1960 年英美协调试验的数据可以在[《天文年历补充说明》1992 年版](https://archive.org/details/explanatorysuppl00pken)第 87 页找到。

|日期|相对频率偏移|步长调整|
|-|-|-|
|1960 年 1 月 1 日|$-150\times10^{-10}$|N/A|
|1961 年 1 月 1 日|$-150\times10^{-10}$|$-0.005\kern{3 mu}\text{s}$|
|1961 年 8 月 1 日|$-150\times10^{-10}$|$+0.050\kern{3 mu}\text{s}$|
|1962 年 1 月 1 日|$-130\times10^{-10}$|$0$|
|1963 年 11 月 1 日|$-130\times10^{-10}$|$-0.100\kern{3 mu}\text{s}$|
|1964 年 1 月 1 日|$-150\times10^{-10}$|$0$|
|1964 年 4 月 1 日|$-150\times10^{-10}$|$-0.100\kern{3 mu}\text{s}$|
|1964 年 9 月 1 日|$-150\times10^{-10}$|$-0.100\kern{3 mu}\text{s}$|
|1965 年 1 月 1 日|$-150\times10^{-10}$|$-0.100\kern{3 mu}\text{s}$|
|1965 年 3 月 1 日|$-150\times10^{-10}$|$-0.100\kern{3 mu}\text{s}$|
|1965 年 7 月 1 日|$-150\times10^{-10}$|$-0.100\kern{3 mu}\text{s}$|
|1965 年 9 月 1 日|$-150\times10^{-10}$|$-0.100\kern{3 mu}\text{s}$|
|1966 年 1 月 1 日|$-300\times10^{-10}$|$0$|
|1968 年 2 月 1 日|$-300\times10^{-10}$|$+0.100\kern{3 mu}\text{s}$|
|1972 年 1 月 1 日|$0$|$-0.1077580\kern{3 mu}\text{s}$|

表中调整均发生在 UTC 的 00:00:00。考虑到 UTC 标度右连续，确定调整时刻时，应使调整时刻对应的 UTC 标度在调整后（而非调整前）恰好成为表中日期的 00:00:00。

步长调整不难理解。UTC 标度一到调整时刻便加上对应的步长调整值，得到后续一段时间所用的 UTC 标度。

设步长调整值为 $s$，调整前的 UTC 标度为 $\text{UTC}\_-$，调整后的 UTC 标度为 $\text{UTC}\_+$，则 $\text{UTC}\_+=\text{UTC}\_-+s$。

相对频率偏移则是信号发射频率的偏移比率。要计算出依 TAI 与 UTC 所计时间的比率，如确定恒星时与平太阳时之间的关系那样探究即可。

设相对频率偏移为 $o$（本文没有用 IAU 第 12 届大会上的记法 $s$，因为 $s$ 已经代表步长调整值了），标称频率为 $f_0=F_0\dfrac{\Delta\nu_\text{Cs}}{9192631770}$，实际频率为 $f=F\dfrac{\Delta\nu_\text{Cs}}{9192631770}$，$n$（可以不是整数）个脉冲依 TAI 与 UTC 所计的时间各为 $\Delta\text{TAI}$ 与 $\Delta\text{UTC}$。

依相对频率偏移的定义有 $f=(1+o)f_0$。

考虑到 SI 秒及频率的定义，立刻得 $\Delta\text{TAI}=\dfrac{n}{F}\kern{3 mu}\text{s}$。

改变发射频率而不变动标称频率是为了令接收方误将 $F$ 取作 $F_0$ 计算——因为接收方是按照上一公式从脉冲计数得到时间的，于是 $\Delta\text{UTC}=\dfrac{n}{F_0}\kern{3 mu}\text{s}$。

$\dfrac{\Delta\text{TAI}}{\Delta\text{UTC}}=\dfrac{F_0}{F}=\dfrac{f_0}{f}=\dfrac{1}{1+o}$

[Bulletin horaire 系列 J](https://bibnum.obspm.fr/ark:/11287/27dZS) 第 1 号第 2 页便写着 $\text{TUC}=\left(1+\dfrac{\Delta f}{f}\right)\text{TA}+B$，这里的 $f$ 实际上是本文的 $f_0$。

历史规定 UTC 的 1972 年 1 月 1 日 00:00:00 对应 TAI 的 1972 年 1 月 1 日 00:00:10，再结合这两个调整量的意义，可以倒推出 TAI-UTC 与 UTC 的关系。

UTC 的 1972 年 1 月 1 日 00:00:00 时 $\text{TAI}-\text{UTC}=10\kern{3 mu}\text{s}$。

已知 UTC 为 $\text{UTC}\_0$ 时 TAI 为 $\text{TAI}\_0$。那么在该时刻至下次调整前的一段时间，自然有 $\text{TAI}-\text{TAI}\_0=\dfrac{\Delta\text{TAI}}{\Delta\text{UTC}}(\text{UTC}-\text{UTC}\_0)$。

$\text{TAI}-\text{UTC}=\text{TAI}\_0+\dfrac{\Delta\text{TAI}}{\Delta\text{UTC}}(\text{UTC}-\text{UTC}\_0)-\text{UTC}=\text{TAI}\_0-\dfrac{\Delta\text{TAI}}{\Delta\text{UTC}}\text{UTC}\_0+\left(\dfrac{\Delta\text{TAI}}{\Delta\text{UTC}}-1\right)\text{UTC}$

$\text{TAI}-\text{UTC}=\text{TAI}\_0-\dfrac{1}{1+o}\text{UTC}\_0-\dfrac{o}{1+o}\text{UTC}$

这样就把 TAI-UTC 写成了关于 UTC 的一次函数。不过，写成下面的形式也许更有用一些。

$\text{TAI}-\text{UTC}=(\text{TAI}\_0-\text{UTC}\_0)-\dfrac{o}{1+o}(\text{UTC}-\text{UTC}\_0)$

实际应用中通常用 literal-MJD 计算，下文对比时记作甲。

$\text{TAI}-\text{UTC}=(\text{TAI}\_0-\text{UTC}\_0)-\dfrac{86400o}{1+o}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-\text{MJD}\_{0\text{ UTC literal}})$

而且计算时为简便起见会将 $\dfrac{o}{1+o}$ 一阶近似作 $o$，下文对比时记作乙。

$\text{TAI}-\text{UTC}=(\text{TAI}\_0-\text{UTC}\_0)-86400o\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-\text{MJD}\_{0\text{ UTC literal}})$

根据 $\text{UTC}\_+=\text{UTC}\_-+s$ 与 $\text{MJD}\_{+\text{ UTC literal}}=\text{MJD}\_{-\text{ UTC literal}}+\dfrac{s}{86400\kern{3 mu}\text{s}}$，依上式倒推 TAI-UTC 的表达式，列表如下。

|日期|TAI-UTC（甲）|TAI-UTC（乙）|
|-|-|-|
|1960 年 1 月 1 日|$\dfrac{28356354111425121133693030}{19999998840000020699999883}\kern{3 mu}\text{s}+\dfrac{259200}{199999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|$\dfrac{70890899507113}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{62500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|
|1961 年 1 月 1 日|$\dfrac{28456354107125121172693030}{19999998840000020699999883}\kern{3 mu}\text{s}+\dfrac{259200}{199999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|$\dfrac{71140899510863}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{62500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|
|1961 年 8 月 1 日|$\dfrac{27456354150125120782693030}{19999998840000020699999883}\kern{3 mu}\text{s}+\dfrac{259200}{199999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|$\dfrac{68640899473363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{62500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|
|1962 年 1 月 1 日|$\dfrac{36917153743310724472405030}{19999998840000020699999883}\kern{3 mu}\text{s}+\dfrac{374400}{333333329}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37665)$|$\dfrac{92292899473363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{351}{312500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37665)$|
|1963 年 11 月 1 日|$\dfrac{12972384551103575124135010}{6666666280000006899999961}\kern{3 mu}\text{s}+\dfrac{374400}{333333329}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37665)$|$\dfrac{97292899538363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{351}{312500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37665)$|
|1964 年 1 月 1 日|$\dfrac{64802593349873090}{19999999100000009}\kern{3 mu}\text{s}+\dfrac{259200}{199999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|$\dfrac{162006499538363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{62500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1964 年 4 月 1 日|$\dfrac{66802593289873090}{19999999100000009}\kern{3 mu}\text{s}+\dfrac{259200}{199999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|$\dfrac{167006499613363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{62500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1964 年 9 月 1 日|$\dfrac{68802593229873090}{19999999100000009}\kern{3 mu}\text{s}+\dfrac{259200}{199999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|$\dfrac{172006499688363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{62500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 1 月 1 日|$\dfrac{70802593169873090}{19999999100000009}\kern{3 mu}\text{s}+\dfrac{259200}{199999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|$\dfrac{177006499763363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{62500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 3 月 1 日|$\dfrac{72802593109873090}{19999999100000009}\kern{3 mu}\text{s}+\dfrac{259200}{199999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|$\dfrac{182006499838363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{62500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 7 月 1 日|$\dfrac{74802593049873090}{19999999100000009}\kern{3 mu}\text{s}+\dfrac{259200}{199999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|$\dfrac{187006499913363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{62500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 9 月 1 日|$\dfrac{76802592989873090}{19999999100000009}\kern{3 mu}\text{s}+\dfrac{259200}{199999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|$\dfrac{192006499988363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{62500}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1966 年 1 月 1 日|$\dfrac{431316970}{99999997}\kern{3 mu}\text{s}+\dfrac{259200}{99999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-39126)$|$\dfrac{215658499988363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{31250}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-39126)$|
|1968 年 2 月 1 日|$\dfrac{421316970}{99999997}\kern{3 mu}\text{s}+\dfrac{259200}{99999997}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-39126)$|$\dfrac{210658499838363}{50000000000000}\kern{3 mu}\text{s}+\dfrac{81}{31250}\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-39126)$|
|1972 年 1 月 1 日|$10\kern{3 mu}\text{s}$|$10\kern{3 mu}\text{s}$|

分析表达式之差，可以看出算法乙的结果总是大于算法甲；最大误差出现在 UTC 的 1960 年 1 月 1 日 00:00:00，为 $\dfrac{209452601676559162777869457667779}{999999942000001034999994150000000000000}\kern{3 mu}\text{s}\doteq2.095\times10^{-7}\kern{3 mu}\text{s}$——要追溯到微秒级自然没问题。

历史上也确实使用算法乙而非算法甲。例如，[Bulletin horaire 系列 J](https://bibnum.obspm.fr/ark:/11287/27dZS) 第 1 号前面的 1966 年频率偏移公告中就出现了「秒信号相隔 $\left(1+300\times10^{-10}\right)$ 原子秒」的字样（相对频率偏移为 $-300\times10^{-10}$）。

而且发射信号时更有可能这么做，因为测量时间的时候用的是铯周期——以 $\dfrac{9192631770}{1+o}$ 个铯周期为秒长就好了。但除法也没那么好算，因此极有可能将 $\dfrac{9192631770}{1+o}$ 近似作 $9192631770(1-o)$ 计算。这样一来算法乙才是标准算法。

[IERS EOC](https://hpiers.obspm.fr/iers/bul/bulc/UTC-TAI.history) 与 [IERS RS/PC](https://maia.usno.navy.mil/ser7/tai-utc.dat) 也提供了算法乙精确到 $10^{-7}\kern{3 mu}\text{s}$ 的表达式。当然，这里顺带补上 1960 年的表达式。此为 [SOFA](https://www.iausofa.org/) 及衍生库 [ERFA](https://github.com/liberfa/erfa) 使用的数据。

|日期|TAI-UTC|
|-|-|
|1960 年 1 月 1 日|$1.4178180\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|
|1961 年 1 月 1 日|$1.4228180\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|
|1961 年 8 月 1 日|$1.3728180\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|
|1962 年 1 月 1 日|$1.8458580\kern{3 mu}\text{s}+0.0011232\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37665)$|
|1963 年 11 月 1 日|$1.9458580\kern{3 mu}\text{s}+0.0011232\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37665)$|
|1964 年 1 月 1 日|$3.2401300\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1964 年 4 月 1 日|$3.3401300\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1964 年 9 月 1 日|$3.4401300\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 1 月 1 日|$3.5401300\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 3 月 1 日|$3.6401300\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 7 月 1 日|$3.7401300\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 9 月 1 日|$3.8401300\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1966 年 1 月 1 日|$4.3131700\kern{3 mu}\text{s}+0.002592\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-39126)$|
|1968 年 2 月 1 日|$4.2131700\kern{3 mu}\text{s}+0.002592\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-39126)$|
|1972 年 1 月 1 日|$10\kern{3 mu}\text{s}$|

[Bulletin horaire 系列 J](https://bibnum.obspm.fr/ark:/11287/27dZS) 第 13 号也给了类似的表达式（见 4 页），精度倒是只有 $10^{-5}\kern{3 mu}\text{s}$ 就是（因此也无法判断使用了算法甲还是算法乙）。当中 1964 年的数据倒是用了从各实际电台信号得出的平均值，与约定数据有所偏差。

#### 1972 年以来的 UTC
1972 年以来，UTC 不再有频率偏移，而只有步长调整，同步对象也从 UT2 改为 UT1。步长也不再采用非整数秒，目前总是 1 秒，称为闰秒。

月末标度插入 1 秒称正闰秒。为了不与次日 00:00:00 混淆，形式上用 23:59:60 表示该秒。

月末标度删去 1 秒称负闰秒。当日就会跳过 23:59:59 而直接进入次日 00:00:00。

需要注意的是，闰秒的正负与上文所提步长调整值的正负正好相反。实则，正闰秒的效果是后续时刻的标度提前，因此有着负的步长调整值；负闰秒的效果是后续时刻的标度滞后，因此有着正的步长调整值。

顺带一提，虽然 23:59:60 的形式标度是 1972 年才开始使用的，但出于消除混淆的需要，1972 年以前的 UTC 也可以使用。

闰秒添加信息可以查阅 IERS 公告 C。IERS 每隔六个月都会发布公告 C，决定添加闰秒也好，不加闰秒也罢，都会提前通知民众。

另外，[Leap_Second.dat](https://hpiers.obspm.fr/iers/bul/bulc/Leap_Second.dat) 中以 TAI-UTC 的形式间接记录了闰秒。TAI-UTC 增加了 1 秒就说明有正闰秒，减小了 1 秒就说明有负闰秒。

一部情况列表如下。

|日期|TAI-UTC|解说|
|-|-|-|
|1972 年 1 月 1 日|$10\kern{3 mu}\text{s}$|从旧 UTC 过渡至新 UTC|
|1972 年 7 月 1 日|$11\kern{3 mu}\text{s}$|1972 年 6 月 30 日插入正闰秒|
|1973 年 1 月 1 日|$12\kern{3 mu}\text{s}$|1972 年 12 月 31 日插入正闰秒|
|1974 年 1 月 1 日|$13\kern{3 mu}\text{s}$|1973 年 12 月 31 日插入正闰秒|
|1975 年 1 月 1 日|$14\kern{3 mu}\text{s}$|1974 年 12 月 31 日插入正闰秒|
|1976 年 1 月 1 日|$15\kern{3 mu}\text{s}$|1975 年 12 月 31 日插入正闰秒|
|1977 年 1 月 1 日|$16\kern{3 mu}\text{s}$|1976 年 12 月 31 日插入正闰秒|
|1978 年 1 月 1 日|$17\kern{3 mu}\text{s}$|1977 年 12 月 31 日插入正闰秒|
|1979 年 1 月 1 日|$18\kern{3 mu}\text{s}$|1978 年 12 月 31 日插入正闰秒|
|1980 年 1 月 1 日|$19\kern{3 mu}\text{s}$|1979 年 12 月 31 日插入正闰秒|
|1981 年 7 月 1 日|$20\kern{3 mu}\text{s}$|1981 年 6 月 30 日插入正闰秒|
|1982 年 7 月 1 日|$21\kern{3 mu}\text{s}$|1982 年 6 月 30 日插入正闰秒|
|1983 年 7 月 1 日|$22\kern{3 mu}\text{s}$|1983 年 6 月 30 日插入正闰秒|
|1985 年 7 月 1 日|$23\kern{3 mu}\text{s}$|1985 年 6 月 30 日插入正闰秒|
|1988 年 1 月 1 日|$24\kern{3 mu}\text{s}$|1987 年 12 月 31 日插入正闰秒|
|1990 年 1 月 1 日|$25\kern{3 mu}\text{s}$|1989 年 12 月 31 日插入正闰秒|
|1991 年 1 月 1 日|$26\kern{3 mu}\text{s}$|1990 年 12 月 31 日插入正闰秒|
|1992 年 7 月 1 日|$27\kern{3 mu}\text{s}$|1992 年 6 月 30 日插入正闰秒|
|1993 年 7 月 1 日|$28\kern{3 mu}\text{s}$|1993 年 6 月 30 日插入正闰秒|
|1994 年 7 月 1 日|$29\kern{3 mu}\text{s}$|1994 年 6 月 30 日插入正闰秒|
|1996 年 1 月 1 日|$30\kern{3 mu}\text{s}$|1995 年 12 月 31 日插入正闰秒|
|1997 年 7 月 1 日|$31\kern{3 mu}\text{s}$|1997 年 6 月 30 日插入正闰秒|
|1999 年 1 月 1 日|$32\kern{3 mu}\text{s}$|1998 年 12 月 31 日插入正闰秒|
|2006 年 1 月 1 日|$33\kern{3 mu}\text{s}$|2005 年 12 月 31 日插入正闰秒|
|2009 年 1 月 1 日|$34\kern{3 mu}\text{s}$|2008 年 12 月 31 日插入正闰秒|
|2012 年 7 月 1 日|$35\kern{3 mu}\text{s}$|2012 年 6 月 30 日插入正闰秒|
|2015 年 7 月 1 日|$36\kern{3 mu}\text{s}$|2015 年 6 月 30 日插入正闰秒|
|2017 年 1 月 1 日|$37\kern{3 mu}\text{s}$|2016 年 12 月 31 日插入正闰秒|

这些年来一直有取消闰秒的呼声。

2022 年 11 月 18 日，CGPM 第 27 届会议[第 4 号决议](https://www.bipm.org/fr/cgpm-2022/resolution-4)表明最迟至 2035 年改变 UT1-UTC 的容许范围，要求至少一个世纪不再对 UTC 施步长调整，实质上取消了闰秒。

但是，UT1 与 TAI 的秒长差异终究还会存在，因此只可能用其它方案代替闰秒（就像，1972 年的变化那样），比方说引入闰分。

### POSIX 时间（Unix 时间戳）
POSIX 时间，或者按通常称作 Unix 时间，自然是 POSIX 记录时间的方案（废话）。所谓 POSIX 就是 IEEE Std 1003 给出的一系列 API 标准。

1986 年 4 月，[IEEE Std 1003.1 试用本](https://archive.org/details/ieeetrialusestan0000inst)发布。53 页 `time()` 的描述写着「`time()` 函数返回距 1970 年 1 月 1 日 00:00:00 GMT 的秒数」，典中典之 GMT。

1988 年 9 月 30 日，[IEEE Std 1003.1-1988](https://archive.org/details/federalinformati1511nati) 发布。77 页 `time()` 的描述写着「`time()` 函数返回距纪元 §2.3 的秒数」，那就看看 2.3 怎么写的好了。

29 页写着「纪元：协调世界时 1970 年 1 月 1 日 0 时 0 分 0 秒。参见『距纪元的秒数』」，当中「距纪元的秒数」见 34 页，也没什么好讲的。还是看看附录 B.2.3 好了。

194 页写着「纪元：通常而言，UNIX 系统时间的原点是指『1970 年 1 月 1 日 00:00:00 GMT』。Greenwich 平均时间实际上并不是国际标准社区认可的术语；因此，术语纪元用于缩写实际标准协调世界时的参考点。增加闰秒的概念是为着精确起见；本标准发布时，自 1970 年 1 月 1 日增加了 14 个闰秒。这 14 秒被忽略，从而提供一种简单且兼容的计算时间差的方法」，也就是说 POSIX 时间基于 UTC 却忽略了闰秒，按照字面读取 UTC 标度，也就有着与 literal-JD 完全相同的问题；「该标准更关注天文上持续时间较短的应用间的时间同步」，说明设计上就没考虑用此计算长跨度时间差。

可见 POSIX 设计上就没有想过处理精确时间，从而不能处理闰秒。但是 POSIX 作为通用框架，势必会在各种场合广泛应用，于是试图保持精确时间的系统往往无法顺利度过闰秒。

2012 年 6 月 30 日插入闰秒时，不少使用 Linux 伺服器或 Java 的网站（例如 Reddit）即刻崩溃。按理说这是个教训，但是 2015 年 6 月 30 日插入闰秒时，NX-OS 之类的路由器系统即刻崩溃，大抵算难以预料的场合；Twitter、Instagram、Pinterest、Netflix、Amazon 等网站也还是崩溃了；甚至美国洲际交易所方面害怕出事，主动暂停运营。

或许，一个合理的标准应该允许实作比标准表现得更好，但很遗憾的是，这一点上 POSIX 并非如此。

### 双闰秒
最初的通用 C 语言标准是 ANSI X3.159-1989，俗称 C89。后来被 ISO/IEC 吸收为 ISO/IEC 9899:1990，只有格式上的变动，俗称 C90。

ANSI X3.159-1989 在 1988 年有个预发布版本 ANSI X3J11/88，有时也称为 C88。

[ANSI X3J11/88-001](http://www.3kranger.com/LabNotes/ANSI-C-X3J1188-Draft.pdf) 中，`tm_sec` 的范围是 \[0, 59\]（见 170 页）。

[ANSI X3J11/88-090](https://web.archive.org/web/20170602191430/http://flash-gordon.me.uk/ansi.c.txt) 中，`tm_sec` 的范围是 \[0, 60\]，而且注释说是为闰秒准备。这就很好了。

但是正式版里面是怎么样的呢？

一看 [ISO/IEC 9899:1990](https://www.yodaiken.com/wp-content/uploads/2021/05/ansi-iso-9899-1990-1.pdf)，就会发现很不合周礼——`tm_sec` 的范围是 \[0, 61\]（见 170 页），怎么烩食呢？注释甚至写着「允许多达两个闰秒」——哪来的两个正闰秒？

双闰秒便是标准 C 的大乌龙。

万恶之源是……Mark Brader，是他。

2001 年 12 月 24 日，Mark Brader 的[某篇回信](https://groups.google.com/g/comp.dcom.telecom/c/Qq0lwZYG_fI/m/Ttieu9Vu3QIJ)里面说道，「恐怕是因为我向 X3J11 建议需要考虑到这一点（双闰秒）。我当时不完全懂闰秒的规则，而且很显然，他们也不懂。我想新标准中已经纠正了这一点」，所以就有了这么个乌龙。

[ISO/IEC 9899:1999](https://www.dii.uchile.cl/~daespino/files/Iso_C_1999_definition.pdf)（俗称 C99）倒确实修了，而且注释写的也是「允许一个正闰秒」。

后来 POSIX 吸收 C 语言时也顺带把所谓双闰秒吸收进去了，2004 年才[修正](https://pubs.opengroup.org/onlinepubs/009604499/basedefs/time.h.html)（见 Issue 6）。

这个乌龙甚至不仅出现在标准 C 中。ANSI X3.135-1992 或者 ISO/IEC 9075:1992，也就是 SQL-92，同样有此问题——出现了「SECOND 的范围允许多达两个『闰秒』」这种鬼话。

一看 ISO/IEC 9075-2:2016 第 225 页，压根就没修这句鬼话。不打算修了是吗？我的评价是「这位更是个（略）」。

### Windows
Windows 从前也不支援闰秒。但是，2018 年 10 月更新起，Windows 10 与 Windows Server 2019 [开始支援闰秒](https://learn.microsoft.com/en-US/troubleshoot/windows-server/identity/support-for-leap-second)。虽然比较晚，而且再考虑之前的闰秒也没有用了（因此只设计了 2018 年 6 月 1 日之后的闰秒跟踪），但这绝对是 IT 界的良好典范。

比方说，我现在就可以在 Windows 10 21H2 执行 `w32tm`：
```
w32tm /leapseconds /getstatus [/verbose]
 显示本地计算机上的闰秒状态。
 详细: 设置详细模式以显示更多信息。
PS C:\Users\Ishisashi\Desktop> w32tm /leapseconds /getstatus
[闰秒]
已启用: 1 (本地)
闰秒数(2018 年 6 月之后): 0 (本地)
```
不觉得很酷吗？作为一名理工男，我觉得这太酷了，很符合我对未来生活的想象。科技并带着趣味。

### 活动：在 literal-MJD 与 quasi-MJD 间转换
考虑到正闰秒，单有 literal-MJD 可能无法确定具体时刻。因此这里就将 UTC 日期的 00:00:00 所对应之 MJD 作为参数 $n$（整数），并令 $n$ 当日的步长调整值为 $s(n)$。

现在就要确定 $(\text{MJD}\_\text{UTC literal},n)$ 与 $\text{MJD}\_\text{UTC quasi}$ 的关系。

UTC 中一天 $n$ 的长度 $d(n)$ 由下一天 $n+1$ 的步长调整值 $s(n+1)$ 决定。由 $\text{UTC}\_+=\text{UTC}\_-+s$ 得 $24\kern{3 mu}\text{h}=d(n)+s(n+1)$，因而有 $d(n)=24\kern{3 mu}\text{h}-s(n+1)$。

$\dfrac{\text{MJD}\_\text{UTC literal}-n}{\text{MJD}\_\text{UTC quasi}-n}=\dfrac{d(n)}{24\kern{3 mu}\text{h}}=\dfrac{24\kern{3 mu}\text{h}-s(n+1)}{24\kern{3 mu}\text{h}}$

$\text{MJD}\_\text{UTC quasi}=n+\dfrac{24\kern{3 mu}\text{h}}{24\kern{3 mu}\text{h}-s(n+1)}(\text{MJD}\_\text{UTC literal}-n)$

注意到 $0\le\text{MJD}\_\text{UTC literal}-n\<\dfrac{24\kern{3 mu}\text{h}-s(n+1)}{24\kern{3 mu}\text{h}}$，故 $0\le\dfrac{24\kern{3 mu}\text{h}}{24\kern{3 mu}\text{h}-s(n+1)}(\text{MJD}\_\text{UTC literal}-n)\<1$，于是 $n=\lfloor\text{MJD}\_\text{UTC quasi}\rfloor$。

$(\text{MJD}\_\text{UTC literal},n)=\left(\lfloor\text{MJD}\_\text{UTC quasi}\rfloor+\dfrac{24\kern{3 mu}\text{h}-s(\lfloor\text{MJD}\_\text{UTC quasi}\rfloor+1)}{24\kern{3 mu}\text{h}}(\text{MJD}\_\text{UTC quasi}-\lfloor\text{MJD}\_\text{UTC quasi}\rfloor),\lfloor\text{MJD}\_\text{UTC quasi}\rfloor\right)$

### 活动：在 TAI MJD 与 UTC quasi-MJD 间转换
此处采用与 [SOFA](https://www.iausofa.org/) 及其衍生库 [ERFA](https://github.com/liberfa/erfa) 兼容（？）的算法。

_TODO：SOFA 的算法貌似[有点问题](https://github.com/liberfa/erfa/issues/92)？暂且假定修正为精确版的算法乙。_

|日期|TAI-UTC|
|-|-|
|1960 年 1 月 1 日|$1.41781799014226\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|
|1961 年 1 月 1 日|$1.42281799021726\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|
|1961 年 8 月 1 日|$1.37281798946726\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37300)$|
|1962 年 1 月 1 日|$1.84585798946726\kern{3 mu}\text{s}+0.0011232\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37665)$|
|1963 年 11 月 1 日|$1.94585799076726\kern{3 mu}\text{s}+0.0011232\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-37665)$|
|1964 年 1 月 1 日|$3.24012999076726\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1964 年 4 月 1 日|$3.34012999226726\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1964 年 9 月 1 日|$3.44012999376726\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 1 月 1 日|$3.54012999526726\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 3 月 1 日|$3.64012999676726\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 7 月 1 日|$3.74012999826726\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1965 年 9 月 1 日|$3.84012999976726\kern{3 mu}\text{s}+0.001296\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-38761)$|
|1966 年 1 月 1 日|$4.31316999976726\kern{3 mu}\text{s}+0.002592\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-39126)$|
|1968 年 2 月 1 日|$4.21316999676726\kern{3 mu}\text{s}+0.002592\kern{3 mu}\text{s}\kern{3 mu}(\text{MJD}\_\text{UTC literal}-39126)$|
|1972 年 1 月 1 日|$10\kern{3 mu}\text{s}$|
|1972 年 7 月 1 日|$11\kern{3 mu}\text{s}$|
|1973 年 1 月 1 日|$12\kern{3 mu}\text{s}$|
|1974 年 1 月 1 日|$13\kern{3 mu}\text{s}$|
|1975 年 1 月 1 日|$14\kern{3 mu}\text{s}$|
|1976 年 1 月 1 日|$15\kern{3 mu}\text{s}$|
|1977 年 1 月 1 日|$16\kern{3 mu}\text{s}$|
|1978 年 1 月 1 日|$17\kern{3 mu}\text{s}$|
|1979 年 1 月 1 日|$18\kern{3 mu}\text{s}$|
|1980 年 1 月 1 日|$19\kern{3 mu}\text{s}$|
|1981 年 7 月 1 日|$20\kern{3 mu}\text{s}$|
|1982 年 7 月 1 日|$21\kern{3 mu}\text{s}$|
|1983 年 7 月 1 日|$22\kern{3 mu}\text{s}$|
|1985 年 7 月 1 日|$23\kern{3 mu}\text{s}$|
|1988 年 1 月 1 日|$24\kern{3 mu}\text{s}$|
|1990 年 1 月 1 日|$25\kern{3 mu}\text{s}$|
|1991 年 1 月 1 日|$26\kern{3 mu}\text{s}$|
|1992 年 7 月 1 日|$27\kern{3 mu}\text{s}$|
|1993 年 7 月 1 日|$28\kern{3 mu}\text{s}$|
|1994 年 7 月 1 日|$29\kern{3 mu}\text{s}$|
|1996 年 1 月 1 日|$30\kern{3 mu}\text{s}$|
|1997 年 7 月 1 日|$31\kern{3 mu}\text{s}$|
|1999 年 1 月 1 日|$32\kern{3 mu}\text{s}$|
|2006 年 1 月 1 日|$33\kern{3 mu}\text{s}$|
|2009 年 1 月 1 日|$34\kern{3 mu}\text{s}$|
|2012 年 7 月 1 日|$35\kern{3 mu}\text{s}$|
|2015 年 7 月 1 日|$36\kern{3 mu}\text{s}$|
|2017 年 1 月 1 日|$37\kern{3 mu}\text{s}$|

此外，输入 UTC 时点早于 1960 年 1 月 1 日的话，输出的 TAI-UTC 将为 0。

不难得出 TAI MJD 关于 UTC literal-MJD 的表达式。

|UTC literal-MJD|TAI MJD|
|-|-|
|$\left(-\infty,\dfrac{159554880047174099507113}{4320000000000000000}\right)$|$\text{MJD}\_\text{UTC literal}$|
|$\left\[36934,\dfrac{644544000001}{17280000}\right)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC literal}-\dfrac{2346149100492887}{4320000000000000000}$|
|$\left\[37300,\dfrac{64820735999}{1728000}\right)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC literal}-\dfrac{2345899100489137}{4320000000000000000}$|
|$\[37512,37665)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC literal}-\dfrac{2348399100526637}{4320000000000000000}$|
|$\left\[37665,\dfrac{33120576001}{864000}\right)$|$\dfrac{1000000013}{1000000000}\text{MJD}\_\text{UTC literal}-\dfrac{2022973500526637}{4320000000000000000}$|
|$\[38334,38395)$|$\dfrac{1000000013}{1000000000}\text{MJD}\_\text{UTC literal}-\dfrac{2017973500461637}{4320000000000000000}$|
|$\left\[38395,\dfrac{33251904001}{864000}\right)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC literal}-\dfrac{2349706300461637}{4320000000000000000}$|
|$\left\[38486,\dfrac{33384096001}{864000}\right)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC literal}-\dfrac{2344706300386637}{4320000000000000000}$|
|$\left\[38639,\dfrac{33489504001}{864000}\right)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC literal}-\dfrac{86655788900431}{160000000000000000}$|
|$\left\[38761,\dfrac{33540480001}{864000}\right)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC literal}-\dfrac{2334706300236637}{4320000000000000000}$|
|$\left\[38820,\dfrac{33645888001}{864000}\right)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC literal}-\dfrac{2329706300161637}{4320000000000000000}$|
|$\left\[38942,\dfrac{33699456001}{864000}\right)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC literal}-\dfrac{774902100028879}{1440000000000000000}$|
|$\[39004,39126)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC literal}-\dfrac{2319706300011637}{4320000000000000000}$|
|$\left\[39126,\dfrac{34462367999}{864000}\right)$|$\dfrac{100000003}{100000000}\text{MJD}\_\text{UTC literal}-\dfrac{4855071100011637}{4320000000000000000}$|
|$\left\[39887,\dfrac{1784894400053879}{43200000000}\right)$|$\dfrac{100000003}{100000000}\text{MJD}\_\text{UTC literal}-\dfrac{1620023700053879}{1440000000000000000}$|
|$\left\[41317,\dfrac{3585513601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{8640}$|
|$\left\[41499,\dfrac{3601411201}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{11}{86400}$|
|$\left\[41683,\dfrac{3632947201}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{7200}$|
|$\left\[42048,\dfrac{3664483201}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{13}{86400}$|
|$\left\[42413,\dfrac{3696019201}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{7}{43200}$|
|$\left\[42778,\dfrac{3727641601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{5760}$|
|$\left\[43144,\dfrac{3759177601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{5400}$|
|$\left\[43509,\dfrac{3790713601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{17}{86400}$|
|$\left\[43874,\dfrac{3822249601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{4800}$|
|$\left\[44239,\dfrac{3869510401}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{19}{86400}$|
|$\left\[44786,\dfrac{3901046401}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{4320}$|
|$\left\[45151,\dfrac{3932582401}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{7}{28800}$|
|$\left\[45516,\dfrac{3995740801}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{11}{43200}$|
|$\left\[46247,\dfrac{4074710401}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{23}{86400}$|
|$\left\[47161,\dfrac{4137868801}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{3600}$|
|$\left\[47892,\dfrac{4169404801}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{3456}$|
|$\left\[48257,\dfrac{4216665601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{13}{43200}$|
|$\left\[48804,\dfrac{4248201601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{3200}$|
|$\left\[49169,\dfrac{4279737601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{7}{21600}$|
|$\left\[49534,\dfrac{4327171201}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{29}{86400}$|
|$\left\[50083,\dfrac{4374432001}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{2880}$|
|$\left\[50630,\dfrac{4421865601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{31}{86400}$|
|$\left\[51179,\dfrac{4642790401}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{2700}$|
|$\left\[53736,\dfrac{4737484801}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{11}{28800}$|
|$\left\[54832,\dfrac{4847817601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{17}{43200}$|
|$\left\[56109,\dfrac{4942425601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{7}{17280}$|
|$\left\[57204,\dfrac{4989945601}{86400}\right)$|$\text{MJD}\_\text{UTC literal}+\dfrac{1}{2400}$|
|$\[57754,?)$|$\text{MJD}\_\text{UTC literal}+\dfrac{37}{86400}$|

依闰秒插入日分段转成 UTC quasi-MJD 即可。

|UTC quasi-MJD|TAI MJD|
|-|-|
|$(-\infty,36933)$|$\text{MJD}\_\text{UTC quasi}$|
|$\[36933,36934)$|$\dfrac{4320047174099507113}{4320000000000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{580760339032068143}{1440000000000000000}$|
|$\[36934,37299)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC quasi}-\dfrac{2346149100492887}{4320000000000000000}$|
|$\[37299,37300)$|$\dfrac{3456000251840003}{3456000000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{11670899240364137}{4320000000000000000}$|
|$\[37300,37511)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC quasi}-\dfrac{2345899100489137}{4320000000000000000}$|
|$\[37511,37512)$|$\dfrac{345599805183997}{345600000000000}\text{MJD}\_\text{UTC quasi}+\dfrac{91431602306173363}{4320000000000000000}$|
|$\[37512,37665)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC quasi}-\dfrac{2348399100526637}{4320000000000000000}$|
|$\[37665,38333)$|$\dfrac{1000000013}{1000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{2022973500526637}{4320000000000000000}$|
|$\[38333,38334)$|$\dfrac{864001011232013}{864000000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{193687975992171637}{4320000000000000000}$|
|$\[38334,38395)$|$\dfrac{1000000013}{1000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{2017973500461637}{4320000000000000000}$|
|$\[38395,38485)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC quasi}-\dfrac{2349706300461637}{4320000000000000000}$|
|$\[38485,38486)$|$\dfrac{172800202592003}{172800000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{64924903062278879}{1440000000000000000}$|
|$\[38486,38638)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC quasi}-\dfrac{2344706300386637}{4320000000000000000}$|
|$\[38638,38639)$|$\dfrac{172800202592003}{172800000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{195534709198236637}{4320000000000000000}$|
|$\[38639,38760)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC quasi}-\dfrac{86655788900431}{160000000000000000}$|
|$\[38760,38761)$|$\dfrac{172800202592003}{172800000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{65379903069103879}{1440000000000000000}$|
|$\[38761,38819)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC quasi}-\dfrac{2334706300236637}{4320000000000000000}$|
|$\[38819,38820)$|$\dfrac{172800202592003}{172800000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{196429709211661637}{4320000000000000000}$|
|$\[38820,38941)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC quasi}-\dfrac{2329706300161637}{4320000000000000000}$|
|$\[38941,38942)$|$\dfrac{172800202592003}{172800000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{197034709220736637}{4320000000000000000}$|
|$\[38942,39003)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC quasi}-\dfrac{774902100028879}{1440000000000000000}$|
|$\[39003,39004)$|$\dfrac{172800202592003}{172800000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{65779903075103879}{1440000000000000000}$|
|$\[39004,39126)$|$\dfrac{200000003}{200000000}\text{MJD}\_\text{UTC quasi}-\dfrac{2319706300011637}{4320000000000000000}$|
|$\[39126,39886)$|$\dfrac{100000003}{100000000}\text{MJD}\_\text{UTC quasi}-\dfrac{4855071100011637}{4320000000000000000}$|
|$\[39886,39887)$|$\dfrac{86399902591997}{86400000000000}\text{MJD}\_\text{UTC quasi}+\dfrac{194574934882888363}{4320000000000000000}$|
|$\[39887,41316)$|$\dfrac{100000003}{100000000}\text{MJD}\_\text{UTC quasi}-\dfrac{1620023700053879}{1440000000000000000}$|
|$\[41316,41317)$|$\dfrac{4320005517500161637}{4320000000000000000}\text{MJD}\_\text{UTC quasi}-\dfrac{25274061575372881}{480000000000000000}$|
|$\[41317,41498)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{8640}$|
|$\[41498,41499)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{2593}{5400}$|
|$\[41499,41682)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{11}{86400}$|
|$\[41682,41683)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{41671}{86400}$|
|$\[41683,42047)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{7200}$|
|$\[42047,42048)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{8407}{17280}$|
|$\[42048,42412)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{13}{86400}$|
|$\[42412,42413)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{4711}{9600}$|
|$\[42413,42777)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{7}{43200}$|
|$\[42777,42778)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{42763}{86400}$|
|$\[42778,43143)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{5760}$|
|$\[43143,43144)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{599}{1200}$|
|$\[43144,43508)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{5400}$|
|$\[43508,43509)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{10873}{21600}$|
|$\[43509,43873)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{17}{86400}$|
|$\[43873,43874)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{2741}{5400}$|
|$\[43874,44238)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{4800}$|
|$\[44238,44239)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{737}{1440}$|
|$\[44239,44785)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{19}{86400}$|
|$\[44785,44786)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{829}{1600}$|
|$\[44786,45150)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{4320}$|
|$\[45150,45151)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{4513}{8640}$|
|$\[45151,45515)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{7}{28800}$|
|$\[45515,45516)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{22747}{43200}$|
|$\[45516,46246)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{11}{43200}$|
|$\[46246,46247)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{107}{200}$|
|$\[46247,47160)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{23}{86400}$|
|$\[47160,47161)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{47137}{86400}$|
|$\[47161,47891)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{3600}$|
|$\[47891,47892)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{47867}{86400}$|
|$\[47892,48256)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{3456}$|
|$\[48256,48257)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{5359}{9600}$|
|$\[48257,48803)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{13}{43200}$|
|$\[48803,48804)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{16259}{28800}$|
|$\[48804,49168)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{3200}$|
|$\[49168,49169)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{49141}{86400}$|
|$\[49169,49533)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{7}{21600}$|
|$\[49533,49534)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{9901}{17280}$|
|$\[49534,50082)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{29}{86400}$|
|$\[50082,50083)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{50053}{86400}$|
|$\[50083,50629)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{2880}$|
|$\[50629,50630)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{50599}{86400}$|
|$\[50630,51178)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{31}{86400}$|
|$\[51178,51179)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{5683}{9600}$|
|$\[51179,53735)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{2700}$|
|$\[53735,53736)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{1989}{3200}$|
|$\[53736,54831)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{11}{28800}$|
|$\[54831,54832)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{9133}{14400}$|
|$\[54832,56108)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{17}{43200}$|
|$\[56108,56109)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{28037}{43200}$|
|$\[56109,57203)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{7}{17280}$|
|$\[57203,57204)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{397}{600}$|
|$\[57204,57753)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{1}{2400}$|
|$\[57753,57754)$|$\dfrac{86401}{86400}\text{MJD}\_\text{UTC quasi}-\dfrac{6413}{9600}$|
|$\[57754,?)$|$\text{MJD}\_\text{UTC quasi}+\dfrac{37}{86400}$|

不过真要写算法肯定不会直接把这种表达式写死，所以 [utctai.c](https://github.com/liberfa/erfa/blob/master/src/utctai.c) 里面还是查闰秒表实现的。

首先确定输入 $u=\text{MJD}\_\text{UTC quasi}$。

$z=\lfloor u\rfloor$

算出 $(\text{MJD}\_\text{UTC literal},n)$ 分别为 $(z,z)$、$\left(z+\dfrac{1}{2},z\right)$、$(z+1,z+1)$ 时的 TAI-UTC，分别记作 $\text{dat0}$、$\text{dat12}$、$\text{dat24}$。

然后以这三个数据计算 TAI-UTC 的日（实则是 UTC 的 86400 秒）变化与闰秒。

$\text{dlod}=2(\text{dat12}-\text{dat0})$

$\text{dlod}$ 也就是 $n=z$ 时的 $86400\kern{3 mu}\text{s}\kern{3 mu}\left(\dfrac{\Delta\text{TAI}}{\Delta\text{UTC}}-1\right)$。

$\text{dleap}=\dfrac{86400\kern{3 mu}\text{s}}{86400\kern{3 mu}\text{s}+\text{dlod}}(\text{dat24}-(\text{dat0}+\text{dlod}))$

这个 $\text{dleap}$ 原本错误地视作 $\text{dat24}-(\text{dat0}+\text{dlod})$，后来本人提议换成从 $\text{dleap}=\text{dat24}-\left(\text{dat0}+\dfrac{24\kern{3 mu}\text{h}+\text{dleap}}{24\kern{3 mu}\text{h}}\text{dlod}\right)$ 解出来的表达式。

不难算出 $\text{dat24}+s(z+1)=\text{dat0}+\left(1-\dfrac{s(z+1)}{24\kern{3 mu}\text{h}}\right)\text{dlod}$，所以对比得 $\text{dleap}=-s(z+1)$。

$\text{fd}=\dfrac{86400\kern{3 mu}\text{s}+\text{dlod}}{86400\kern{3 mu}\text{s}}\dfrac{86400\kern{3 mu}\text{s}+\text{dleap}}{86400\kern{3 mu}\text{s}}(u-z)$

依上节有 $\text{MJD}\_\text{UTC literal}=z+\dfrac{24\kern{3 mu}\text{h}-s(z+1)}{24\kern{3 mu}\text{h}}(u-z)$。

因此 $\text{fd}=\dfrac{86400\kern{3 mu}\text{s}+\text{dlod}}{86400\kern{3 mu}\text{s}}\left(\text{MJD}\_\text{UTC literal}-z\right)=\dfrac{\Delta\text{TAI}}{\Delta\text{UTC}}(\text{MJD}\_\text{UTC literal}-z)$。

$a=z+\text{fd}+\dfrac{\text{dat0}}{86400\kern{3 mu}\text{s}}$

注意到 $\text{dat0}$ 原本就是 $(\text{MJD}\_\text{UTC literal},n)$ 为 $(z,z)$ 时的 TAI-UTC，所以 $z+\dfrac{\text{dat0}}{86400\kern{3 mu}\text{s}}$ 同时也是此时的 TAI MJD。

于是 $\text{MJD}\_\text{TAI}-\left(z+\dfrac{\text{dat0}}{86400\kern{3 mu}\text{s}}\right)=\dfrac{\Delta\text{TAI}}{\Delta\text{UTC}}(\text{MJD}\_\text{UTC literal}-z)$，对比得 $a=\text{MJD}\_\text{TAI}$。

以上变换记作 $a=\operatorname{utctai}(u)$

[taiutc.c](https://github.com/liberfa/erfa/blob/master/src/taiutc.c) 则是用 [utctai.c](https://github.com/liberfa/erfa/blob/master/src/utctai.c) 迭代得到的。

首先确定输入 $a=\text{MJD}\_\text{TAI}$。

迭代的初值条件为 $u_0=a$，算法为 $u_{n+1}=u_n+a-\operatorname{utctai}(u_n)$。

若设 $\operatorname{utctai}(x)=kx+b$，该迭代法只有 $0\<k\<2$ 时才收敛，并且 $k$ 越接近 $1$ 收敛速度越快，$k=1$ 时一次迭代就得到了精确值。

当然了，之前表格里出现的 $k$ 最小值与最大值分别是 $\dfrac{86399902591997}{86400000000000}$ 与 $\dfrac{86401}{86400}$。偏差估大点也就 $\left(-1.2\times10^{-6},1.2\times10^{-5}\right)$，可以说问题不大。

令 $\displaystyle u=\lim u_n$，则 $\operatorname{utctai}(u)=a$。因此 $u=\text{MJD}\_\text{UTC quasi}$。

收敛速度很快，迭代几次就很精确了，于是可以看到代码里面直接取了 $\displaystyle u=u_3$。当然注释里也说大部分情形一次就够——毕竟 1972 年以来 UTC 并没有改变秒长，时点满足 $k=1$ 的概率还是不低的。

这样又得到了 $u=\operatorname{taiutc}(a)$ 的可行算法。

## 动力学时
### 历书时
19 世纪末，人们已经意识到地球自转周期在不断变化，因此依靠地球自转周期计时并不均匀。如果已知太阳系天体关于时刻的运动方程，就可以透过天体运动状态逆推出时间。

1952 年 IAU 第 8 届大会决定创建历书时（Ephemeris Time, ET）。

1960 年 10 月，CGPM 第 11 届会议[第 9 号决议](https://www.bipm.org/fr/committees/cg/cgpm/11-1960/resolution-1)首次定义 SI 秒：秒是历书时 1900 年 1 月 0 日（历书中为了避免引用前一年，会将前一年的 12 月 31 日写作本年的 1 月 0 日）12 时回归年的 $\dfrac{1}{31556925.9747}$。这就是前文所述的历书秒。

### 相对论动力学时
历书时算是动力学时，因为它由运动方程解出。但它以经典力学为动力学基础，没有考虑相对论效应。从长远计时考虑，相对论修正相当有必要。

1976 年 [IAU 第 16 届大会](https://www.iau.org/static/resolutions/IAU1976_French.pdf)上，第 4 委员会的第 5 号建议中提出了 ET 的相对论替代品，但是没有命名。

1979 年 [IAU 第 17 届大会](https://www.iau.org/static/resolutions/IAU1979_French.pdf)上，第 4、19 和 31 委员会的决议 5 则给出了名称。从太阳系质心与地心的运动方程得出的动力学时分别称为质心动力学时（法 Temps dynamique barycentrique, TDB、英 Barycentric Dynamical Time）与地球动力学时（法 Temps dynamique terrestre, TDT、英 Terrestrial Dynamical Time）。

1991 年 [IAU 第 21 届大会](https://www.iau.org/static/resolutions/IAU1991_French.pdf)决议 A4 提出了地心坐标时（法 Temps-coordonnée géocentrique, TCG、英 Geocentric Coordinate Time）与质心坐标时（法 Temps-coordonnée barycentrique, TCB、英 Barycentric Coordinate Time），并将 TDT 更名为地球时（法 Temps terrestre, TT、英 Terrestrial Time）。

2000 年 [IAU 第 24 届大会](https://www.iau.org/static/resolutions/IAU2000_French.pdf)决议 B1.5 完善了 TCG 与 TCB 的概念。

2006 年 IAU 第 26 届大会[决议 3](https://www.iau.org/static/resolutions/IAU2006_Resol3.pdf) 提出了 TDB 的严格定义。

#### 地球时
TT 定义为 TCG 的线性变换，比例系数为 $\dfrac{d\text{TT}}{d\text{TCG}}=1-L_G$。

$\text{TCG}-\text{TT}=\dfrac{L_G}{1-L_G}(\text{JD}\_\text{TT}-T_0)86400\kern{3 mu}\text{s}$（其中 $L_G=6.969290134\times10^{-10}$、$T_0=2443144.5003725$）

由于 TAI 为 1977 年 1 月 1 日 00:00:00.000 的时刻 ET 为 1977 年 1 月 1 日 00:00:32.184，考虑到 TT 与 ET 的继承关系，此时的 TT 也就定义为 1977 年 1 月 1 日 00:00:32.184。

不难注意到，JD 2443144.5003725 对应的也就是 1977 年 1 月 1 日 00:00:32.184。而且，这正是 TAI 开始考虑引力时间膨胀的时点。

$\text{JD}\_\text{TT}=T_0$ 时 $\text{TCG}-\text{TT}=0$，说明 TCG 和 TT 的 1977 年 1 月 1 日 00:00:32.184 都指向 TAI 的 1977 年 1 月 1 日 00:00:00.000。

另外 TT 与 TAI 的秒长均为大地水准面上的 SI 秒，因此两者有着相当简单的关系。

$\text{TT}=\text{TAI}+32.184\kern{3 mu}\text{s}$

这样，TAI 本身就可以作为 TT 的一个实现。当然，TT 也能用其它方法实现——毕竟动力学时当然可以用动力学的手段确定。

[TT(BIPM)](https://www.bipm.org/fr/time-ftp/tt-bipm-) 是基于 TAI 原始数据精细计算得到的 TT 实现。TAI 每月计算一次，顾及实时而不够准确；TT(BIPM) 则是每年计算一次，能够利用更多的数据，显得更为平滑。

#### 质心动力学时
TDB 定义为 TCB 的线性变换，比例系数为 $\dfrac{d\text{TDB}}{d\text{TCB}}=1-L_B$。

$\text{TDB}=\text{TCB}-L_B(\text{JD}\_\text{TCB}-T_0)86400\kern{3 mu}\text{s}+\text{TDB}\_0$（其中 $L_B=1.550519768\times10^{-8}$、$T_0=2443144.5003725$、$\text{TDB}\_0=-6.55\times10^{-5}\kern{3 mu}\text{s}$）

在地心处，TCB 的 1977 年 1 月 1 日 00:00:32.184 也指向 TAI 的 1977 年 1 月 1 日 00:00:00.000。但由于 $\text{TDB}\_0\ne0$，TDB 便并非如此。

#### 在两种坐标时间转换
TCG 与 TCB 的差异原本就是相对论效应造成的，自然需要考虑时空坐标。不妨以三维径矢与时刻作为参数写出表达式。

$\displaystyle\text{TCB}-\text{TCG}=c^{-2}\left(\left.\int_{t_0}^{T}\left(\dfrac{\|\vec v_e\|^2}{2}+U_\text{ext}(\vec x_e)\right)dt\right\|\_{T=t}+\vec v_e\cdot(\vec x-\vec x_e)\right)-c^{-4}\left(\left.\int_{t_0}^{T}\left(-\dfrac{1}{8}\|\vec v_e\|^4-\dfrac{3}{2}\|\vec v_e\|^2U_\text{ext}(\vec x_e)+4\vec v_e\cdot\vec V_\text{ext}(\vec x_e)+\dfrac{1}{2}U_\text{ext}^2(\vec x_e)\right)dt\right\|\_{T=t}-\left(3U_\text{ext}(\vec x_e)+\dfrac{\|\vec v_e\|^2}{2}\right)\vec v_e\cdot(\vec x-\vec x_e)\right)$

其中 $\vec x$ 为 BCRS 中的径矢，$\vec x_e$ 与 $\vec v_e$ 分别为地心在 BCRS 中的径矢与速度，$\displaystyle U_\text{ext}(\vec r)=G\sum_{A\ne\text{Earth}}\dfrac{M_A}{\|\vec r-\vec x_A\|}$ 且 $\displaystyle\vec V_\text{ext}(\vec r)=G\sum_{A\ne\text{Earth}}\left(-\dfrac{(\vec r-\vec x_A)\times\vec S_A}{2\|\vec r-\vec x_A\|^3}+\dfrac{M_A\vec v_A}{\|\vec r-\vec x_A\|}\right)$（$A\ne\text{Earth}$ 表示 $A$ 遍历太阳系中地球以外的一切天体，$\vec S_A$ 表示 $A$ 的总角动量，$\vec x_A$ 与 $\vec v_A$ 分别为 $A$ 在 BCRS 中的径矢与速度），$t$ 为 TCB，$t_0$ 为 TCB 的 1977 年 1 月 1 日 00:00:32.184，$c$ 为真空光速。

特别地，$(t,\vec x)=(t_0,\vec x_e)$ 时有 $\text{TCB}-\text{TCG}=0$，即地心处 TCG 与 TCB 的 1977 年 1 月 1 日 00:00:32.184 相同。

$c^{-4}$ 项及后面省略的余项占比大致是 $10^{-16}$。


